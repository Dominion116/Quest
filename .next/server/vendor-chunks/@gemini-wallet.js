"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@gemini-wallet";
exports.ids = ["vendor-chunks/@gemini-wallet"];
exports.modules = {

/***/ "(ssr)/./node_modules/@gemini-wallet/core/dist/index.js":
/*!********************************************************!*\
  !*** ./node_modules/@gemini-wallet/core/dist/index.js ***!
  \********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Communicator: () => (/* binding */ Communicator),\n/* harmony export */   DEFAULT_CHAIN_ID: () => (/* binding */ DEFAULT_CHAIN_ID),\n/* harmony export */   GeminiSdkEvent: () => (/* binding */ GeminiSdkEvent),\n/* harmony export */   GeminiStorage: () => (/* binding */ GeminiStorage),\n/* harmony export */   GeminiWallet: () => (/* binding */ GeminiWallet),\n/* harmony export */   GeminiWalletProvider: () => (/* binding */ GeminiWalletProvider),\n/* harmony export */   POPUP_HEIGHT: () => (/* binding */ POPUP_HEIGHT),\n/* harmony export */   POPUP_WIDTH: () => (/* binding */ POPUP_WIDTH),\n/* harmony export */   PlatformType: () => (/* binding */ PlatformType),\n/* harmony export */   ProviderEventEmitter: () => (/* binding */ ProviderEventEmitter),\n/* harmony export */   SDK_BACKEND_URL: () => (/* binding */ SDK_BACKEND_URL),\n/* harmony export */   SDK_VERSION: () => (/* binding */ SDK_VERSION),\n/* harmony export */   STORAGE_ETH_ACCOUNTS_KEY: () => (/* binding */ STORAGE_ETH_ACCOUNTS_KEY),\n/* harmony export */   STORAGE_ETH_ACTIVE_CHAIN_KEY: () => (/* binding */ STORAGE_ETH_ACTIVE_CHAIN_KEY),\n/* harmony export */   STORAGE_PASSKEY_CREDENTIAL_KEY: () => (/* binding */ STORAGE_PASSKEY_CREDENTIAL_KEY),\n/* harmony export */   STORAGE_PRESERVED_PASSKEY_CREDENTIALS_KEY: () => (/* binding */ STORAGE_PRESERVED_PASSKEY_CREDENTIALS_KEY),\n/* harmony export */   STORAGE_SETTINGS_KEY: () => (/* binding */ STORAGE_SETTINGS_KEY),\n/* harmony export */   STORAGE_SMART_ACCOUNT_KEY: () => (/* binding */ STORAGE_SMART_ACCOUNT_KEY),\n/* harmony export */   STORAGE_WC_REQUESTS_KEY: () => (/* binding */ STORAGE_WC_REQUESTS_KEY),\n/* harmony export */   base64ToHex: () => (/* binding */ base64ToHex),\n/* harmony export */   bufferToBase64URLString: () => (/* binding */ bufferToBase64URLString),\n/* harmony export */   calculateV1Address: () => (/* binding */ calculateV1Address),\n/* harmony export */   calculateWalletAddress: () => (/* binding */ calculateWalletAddress),\n/* harmony export */   closePopup: () => (/* binding */ closePopup),\n/* harmony export */   convertSendValuesToBigInt: () => (/* binding */ convertSendValuesToBigInt),\n/* harmony export */   decodeBase64: () => (/* binding */ decodeBase64),\n/* harmony export */   encodeBase64: () => (/* binding */ encodeBase64),\n/* harmony export */   fetchRpcRequest: () => (/* binding */ fetchRpcRequest),\n/* harmony export */   generateAuthenticatorIdHash: () => (/* binding */ generateAuthenticatorIdHash),\n/* harmony export */   hexStringFromNumber: () => (/* binding */ hexStringFromNumber),\n/* harmony export */   isChainSupportedByGeminiSw: () => (/* binding */ isChainSupportedByGeminiSw),\n/* harmony export */   openPopup: () => (/* binding */ openPopup),\n/* harmony export */   reverseResolveEns: () => (/* binding */ reverseResolveEns),\n/* harmony export */   safeJsonStringify: () => (/* binding */ safeJsonStringify),\n/* harmony export */   utf8StringToBuffer: () => (/* binding */ utf8StringToBuffer),\n/* harmony export */   validateRpcRequestArgs: () => (/* binding */ validateRpcRequestArgs),\n/* harmony export */   validateWebAuthnKey: () => (/* binding */ validateWebAuthnKey)\n/* harmony export */ });\n/* harmony import */ var _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @metamask/rpc-errors */ \"(ssr)/./node_modules/@metamask/rpc-errors/dist/errors.mjs\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! viem/chains */ \"(ssr)/./node_modules/viem/_esm/chains/definitions/mainnet.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! viem/chains */ \"(ssr)/./node_modules/viem/_esm/chains/definitions/arbitrum.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! viem/chains */ \"(ssr)/./node_modules/viem/_esm/chains/definitions/optimism.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! viem/chains */ \"(ssr)/./node_modules/viem/_esm/chains/definitions/base.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! viem/chains */ \"(ssr)/./node_modules/viem/_esm/chains/definitions/polygon.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! viem/chains */ \"(ssr)/./node_modules/viem/_esm/chains/definitions/sepolia.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! viem/chains */ \"(ssr)/./node_modules/viem/_esm/chains/definitions/arbitrumSepolia.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! viem/chains */ \"(ssr)/./node_modules/viem/_esm/chains/definitions/optimismSepolia.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! viem/chains */ \"(ssr)/./node_modules/viem/_esm/chains/definitions/baseSepolia.js\");\n/* harmony import */ var viem_chains__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! viem/chains */ \"(ssr)/./node_modules/viem/_esm/chains/definitions/polygonAmoy.js\");\n/* harmony import */ var eventemitter3__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! eventemitter3 */ \"(ssr)/./node_modules/eventemitter3/index.mjs\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! viem */ \"(ssr)/./node_modules/viem/_esm/utils/hash/keccak256.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! viem */ \"(ssr)/./node_modules/viem/_esm/utils/abi/encodePacked.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! viem */ \"(ssr)/./node_modules/viem/_esm/utils/abi/encodeAbiParameters.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! viem */ \"(ssr)/./node_modules/viem/_esm/utils/abi/encodeFunctionData.js\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! viem */ \"(ssr)/./node_modules/viem/_esm/utils/address/getContractAddress.js\");\n/* harmony import */ var _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @metamask/rpc-errors */ \"(ssr)/./node_modules/@metamask/rpc-errors/dist/error-constants.mjs\");\n/* harmony import */ var _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @metamask/rpc-errors */ \"(ssr)/./node_modules/@metamask/rpc-errors/dist/utils.mjs\");\n/* harmony import */ var viem__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! viem */ \"(ssr)/./node_modules/viem/_esm/utils/data/isHex.js\");\n// src/communicator.ts\n\n\n// src/constants.ts\n\n\n// package.json\nvar package_default = {\n  name: \"@gemini-wallet/core\",\n  version: \"0.3.1\",\n  description: \"Core SDK for Gemini Wallet integration with popup communication\",\n  main: \"./dist/index.cjs\",\n  types: \"./dist/index.d.ts\",\n  type: \"module\",\n  repository: {\n    type: \"git\",\n    url: \"git+https://github.com/gemini/gemini-wallet-core.git\"\n  },\n  homepage: \"https://keys.gemini.com\",\n  bugs: {\n    url: \"https://github.com/gemini/gemini-wallet-core/issues\"\n  },\n  license: \"MIT\",\n  author: \"Gemini\",\n  files: [\n    \"dist\",\n    \"src\",\n    \"README.md\",\n    \"LICENSE\"\n  ],\n  exports: {\n    \".\": {\n      types: \"./dist/index.d.ts\",\n      import: \"./dist/index.js\",\n      require: \"./dist/index.cjs\"\n    },\n    \"./package.json\": \"./package.json\"\n  },\n  scripts: {\n    build: \"dotenv -e .env.production -- tsup\",\n    dev: \"dotenv -e .env.local -- tsup --watch\",\n    typecheck: \"tsc --noEmit\",\n    lint: \"eslint ./src\",\n    \"lint:ci\": \"eslint --max-warnings 0 ./src\",\n    \"lint:fix\": \"eslint ./src --fix\",\n    test: \"bun test\"\n  },\n  dependencies: {\n    \"@metamask/rpc-errors\": \"7.0.2\",\n    eventemitter3: \"5.0.1\"\n  },\n  devDependencies: {\n    \"@eslint/eslintrc\": \"3.3.1\",\n    \"@eslint/js\": \"9.33.0\",\n    \"@next/eslint-plugin-next\": \"15.4.7\",\n    \"@types/node\": \"22.13.0\",\n    \"dotenv-cli\": \"10.0.0\",\n    \"esbuild-plugin-replace\": \"1.4.0\",\n    eslint: \"9.33.0\",\n    \"eslint-config-prettier\": \"10.1.8\",\n    \"eslint-config-turbo\": \"2.5.6\",\n    \"eslint-plugin-import\": \"2.32.0\",\n    \"eslint-plugin-jsx-a11y\": \"6.10.2\",\n    \"eslint-plugin-only-warn\": \"1.1.0\",\n    \"eslint-plugin-prettier\": \"5.5.4\",\n    \"eslint-plugin-react\": \"7.37.5\",\n    \"eslint-plugin-react-hooks\": \"5.2.0\",\n    \"eslint-plugin-simple-import-sort\": \"12.1.1\",\n    \"eslint-plugin-sort-keys-fix\": \"1.1.2\",\n    globals: \"16.3.0\",\n    prettier: \"3.6.2\",\n    tsup: \"8.4.0\",\n    typescript: \"5.5.3\",\n    \"typescript-eslint\": \"8.40.0\",\n    vitest: \"3.2.4\"\n  },\n  peerDependencies: {\n    viem: \">=2.0.0\"\n  },\n  keywords: [\n    \"gemini\",\n    \"wallet\",\n    \"sdk\",\n    \"ethereum\",\n    \"web3\",\n    \"crypto\"\n  ],\n  module: \"./dist/index.js\"\n};\n\n// src/constants.ts\nvar DEFAULT_BACKEND_URL = \"https://keys.gemini.com\";\nvar SDK_BACKEND_URL = typeof process !== \"undefined\" && \"undefined\" || DEFAULT_BACKEND_URL;\nvar ENS_API_URL = \"https://horizon-api.gemini.com/api/ens\";\nvar SDK_VERSION = package_default.version;\nvar DEFAULT_CHAIN_ID = 42161;\nvar MAINNET_CHAIN_IDS = {\n  ARBITRUM_ONE: 42161,\n  BASE: 8453,\n  ETHEREUM: 1,\n  OP_MAINNET: 10,\n  POLYGON: 137\n};\nvar TESTNET_CHAIN_IDS = {\n  ARBITRUM_SEPOLIA: 421614,\n  BASE_SEPOLIA: 84532,\n  OP_SEPOLIA: 11155420,\n  POLYGON_AMOY: 80002,\n  SEPOLIA: 11155111\n};\nvar SUPPORTED_CHAIN_IDS = [\n  ...Object.values(MAINNET_CHAIN_IDS),\n  ...Object.values(TESTNET_CHAIN_IDS)\n];\nfunction getDefaultRpcUrl(chainId) {\n  const chainMap = {\n    [viem_chains__WEBPACK_IMPORTED_MODULE_0__.mainnet.id]: viem_chains__WEBPACK_IMPORTED_MODULE_0__.mainnet.rpcUrls.default.http[0],\n    [viem_chains__WEBPACK_IMPORTED_MODULE_1__.arbitrum.id]: viem_chains__WEBPACK_IMPORTED_MODULE_1__.arbitrum.rpcUrls.default.http[0],\n    [viem_chains__WEBPACK_IMPORTED_MODULE_2__.optimism.id]: viem_chains__WEBPACK_IMPORTED_MODULE_2__.optimism.rpcUrls.default.http[0],\n    [viem_chains__WEBPACK_IMPORTED_MODULE_3__.base.id]: viem_chains__WEBPACK_IMPORTED_MODULE_3__.base.rpcUrls.default.http[0],\n    [viem_chains__WEBPACK_IMPORTED_MODULE_4__.polygon.id]: viem_chains__WEBPACK_IMPORTED_MODULE_4__.polygon.rpcUrls.default.http[0],\n    [viem_chains__WEBPACK_IMPORTED_MODULE_5__.sepolia.id]: viem_chains__WEBPACK_IMPORTED_MODULE_5__.sepolia.rpcUrls.default.http[0],\n    [viem_chains__WEBPACK_IMPORTED_MODULE_6__.arbitrumSepolia.id]: viem_chains__WEBPACK_IMPORTED_MODULE_6__.arbitrumSepolia.rpcUrls.default.http[0],\n    [viem_chains__WEBPACK_IMPORTED_MODULE_7__.optimismSepolia.id]: viem_chains__WEBPACK_IMPORTED_MODULE_7__.optimismSepolia.rpcUrls.default.http[0],\n    [viem_chains__WEBPACK_IMPORTED_MODULE_8__.baseSepolia.id]: viem_chains__WEBPACK_IMPORTED_MODULE_8__.baseSepolia.rpcUrls.default.http[0],\n    [viem_chains__WEBPACK_IMPORTED_MODULE_9__.polygonAmoy.id]: viem_chains__WEBPACK_IMPORTED_MODULE_9__.polygonAmoy.rpcUrls.default.http[0]\n  };\n  return chainMap[chainId];\n}\nvar POPUP_WIDTH = 420;\nvar POPUP_HEIGHT = 650;\n\n// src/types.ts\n\nvar GeminiSdkEvent = /* @__PURE__ */ ((GeminiSdkEvent2) => {\n  GeminiSdkEvent2[\"POPUP_LOADED\"] = \"POPUP_LOADED\";\n  GeminiSdkEvent2[\"POPUP_UNLOADED\"] = \"POPUP_UNLOADED\";\n  GeminiSdkEvent2[\"POPUP_APP_CONTEXT\"] = \"POPUP_APP_CONTEXT\";\n  GeminiSdkEvent2[\"SDK_CONNECT\"] = \"SDK_CONNECT\";\n  GeminiSdkEvent2[\"SDK_DISCONNECT\"] = \"SDK_DISCONNECT\";\n  GeminiSdkEvent2[\"SDK_SEND_TRANSACTION\"] = \"SDK_SEND_TRANSACTION\";\n  GeminiSdkEvent2[\"SDK_SIGN_DATA\"] = \"SDK_SIGN_DATA\";\n  GeminiSdkEvent2[\"SDK_SIGN_TYPED_DATA\"] = \"SDK_SIGN_TYPED_DATA\";\n  GeminiSdkEvent2[\"SDK_SWITCH_CHAIN\"] = \"SDK_SWITCH_CHAIN\";\n  GeminiSdkEvent2[\"SDK_OPEN_SETTINGS\"] = \"SDK_OPEN_SETTINGS\";\n  GeminiSdkEvent2[\"SDK_CURRENT_ACCOUNT\"] = \"SDK_CURRENT_ACCOUNT\";\n  return GeminiSdkEvent2;\n})(GeminiSdkEvent || {});\nvar PlatformType = {\n  REACT_NATIVE: \"REACT_NATIVE\",\n  WEB: \"WEB\"\n};\nvar ProviderEventEmitter = class extends eventemitter3__WEBPACK_IMPORTED_MODULE_10__.EventEmitter {\n};\n\n// src/utils/base64.ts\nfunction encodeBase64(array) {\n  let base64;\n  if (typeof Buffer !== \"undefined\") {\n    base64 = Buffer.from(array).toString(\"base64\");\n  } else {\n    base64 = btoa(\n      Array.from(array).map((b) => String.fromCharCode(b)).join(\"\")\n    );\n  }\n  return base64.replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/, \"\");\n}\nfunction decodeBase64(base64url) {\n  let base64 = base64url.replace(/-/g, \"+\").replace(/_/g, \"/\");\n  while (base64.length % 4 !== 0) {\n    base64 += \"=\";\n  }\n  if (typeof Buffer !== \"undefined\") {\n    return new Uint8Array(Buffer.from(base64, \"base64\"));\n  } else {\n    const binaryString = atob(base64);\n    const bytes = new Uint8Array(binaryString.length);\n    for (let i = 0; i < binaryString.length; i++) {\n      bytes[i] = binaryString.charCodeAt(i);\n    }\n    return bytes;\n  }\n}\nfunction bufferToBase64URLString(buffer) {\n  const bytes = buffer instanceof Uint8Array ? buffer : new Uint8Array(buffer);\n  return encodeBase64(bytes);\n}\nfunction utf8StringToBuffer(value) {\n  if (typeof TextEncoder !== \"undefined\") {\n    return new TextEncoder().encode(value);\n  } else if (typeof Buffer !== \"undefined\") {\n    return new Uint8Array(Buffer.from(value, \"utf8\"));\n  } else {\n    const bytes = new Uint8Array(value.length);\n    for (let i = 0; i < value.length; i++) {\n      bytes[i] = value.charCodeAt(i);\n    }\n    return bytes;\n  }\n}\nfunction base64ToHex(base64) {\n  const bytes = decodeBase64(base64);\n  return Array.from(bytes).map((b) => b.toString(16).padStart(2, \"0\")).join(\"\");\n}\n\n// src/utils/calculateWalletAddress.ts\n\nvar SHARED_CONTRACT_ADDRESSES = {\n  ATTESTER: \"0x000474392a9cd86a4687354f1Ce2964B52e97484\",\n  BOOTSTRAPPER: \"0x00000000D3254452a909E4eeD47455Af7E27C289\",\n  REGISTRY: \"0x000000000069E2a187AEFFb852bF3cCdC95151B2\"\n};\nvar V2_CONTRACT_ADDRESSES = {\n  ...SHARED_CONTRACT_ADDRESSES,\n  ACCOUNT_IMPLEMENTATION: \"0x00000000029d9c8b864DD51d6bb0d99FB72D650b\",\n  FACTORY: \"0x000000000452377e1Bd9e72E939855ECb9363Cab\",\n  WEBAUTHN_VALIDATOR: \"0x7ab16Ff354AcB328452F1D445b3Ddee9a91e9e69\"\n};\nvar V1_CONTRACT_ADDRESSES = {\n  ...SHARED_CONTRACT_ADDRESSES,\n  ACCOUNT_IMPLEMENTATION: \"0x0006050168DE255a8672ACaD4821e721CBA44337\",\n  FACTORY: \"0x00E58DF70FaB983a324c4C068c82d20407579FaC\",\n  WEBAUTHN_VALIDATOR: \"0xbA45a2BFb8De3D24cA9D7F1B551E14dFF5d690Fd\"\n};\nfunction processWalletAddressParams(params, contractAddresses) {\n  const { publicKey, credentialId, index = 0n } = params;\n  if (!publicKey.startsWith(\"0x\") || publicKey.length !== 130) {\n    throw new Error(\n      \"Invalid public key: must be 64-byte hex string (0x + 128 chars)\"\n    );\n  }\n  const pubKeyX = `0x${publicKey.slice(2, 66)}`;\n  const pubKeyY = `0x${publicKey.slice(66, 130)}`;\n  const webAuthnData = {\n    pubKeyX: BigInt(pubKeyX),\n    pubKeyY: BigInt(pubKeyY)\n  };\n  if (!validateWebAuthnKey(webAuthnData)) {\n    throw new Error(\n      \"Invalid WebAuthn key: coordinates are not on secp256r1 curve\"\n    );\n  }\n  const authenticatorIdHash = generateAuthenticatorIdHash(credentialId);\n  return calculateAddressInternal({\n    authenticatorIdHash,\n    contractAddresses,\n    index,\n    webAuthnData\n  });\n}\nfunction calculateWalletAddress(params) {\n  return processWalletAddressParams(params, V2_CONTRACT_ADDRESSES);\n}\nfunction calculateV1Address(params) {\n  return processWalletAddressParams(params, V1_CONTRACT_ADDRESSES);\n}\nfunction generateAuthenticatorIdHash(credentialId) {\n  const padding = \"=\".repeat((4 - credentialId.length % 4) % 4);\n  const base64 = credentialId.replace(/-/g, \"+\").replace(/_/g, \"/\") + padding;\n  const binaryString = atob(base64);\n  const bytes = new Uint8Array(binaryString.length);\n  for (let i = 0; i < binaryString.length; i++) {\n    bytes[i] = binaryString.charCodeAt(i);\n  }\n  return (0,viem__WEBPACK_IMPORTED_MODULE_11__.keccak256)(bytes);\n}\nfunction validateWebAuthnKey(webAuthnData) {\n  const SECP256R1_P = 0xffffffff00000001000000000000000000000000ffffffffffffffffffffffffn;\n  const SECP256R1_B = 0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604bn;\n  const { pubKeyX, pubKeyY } = webAuthnData;\n  if (pubKeyX === 0n || pubKeyY === 0n || pubKeyX >= SECP256R1_P || pubKeyY >= SECP256R1_P) {\n    return false;\n  }\n  const ySquared = pubKeyY * pubKeyY % SECP256R1_P;\n  const xCubed = pubKeyX * pubKeyX * pubKeyX % SECP256R1_P;\n  const threeX = 3n * pubKeyX % SECP256R1_P;\n  const rightSide = (xCubed + SECP256R1_P - threeX + SECP256R1_B) % SECP256R1_P;\n  return ySquared === rightSide;\n}\nfunction calculateAddressInternal(params) {\n  const { webAuthnData, authenticatorIdHash, index, contractAddresses } = params;\n  const factoryAddress = contractAddresses.FACTORY;\n  const accountImplementation = contractAddresses.ACCOUNT_IMPLEMENTATION;\n  const webAuthnValidator = contractAddresses.WEBAUTHN_VALIDATOR;\n  const attester = contractAddresses.ATTESTER;\n  const bootstrapper = contractAddresses.BOOTSTRAPPER;\n  const registry = contractAddresses.REGISTRY;\n  const salt = (0,viem__WEBPACK_IMPORTED_MODULE_11__.keccak256)(\n    (0,viem__WEBPACK_IMPORTED_MODULE_12__.encodePacked)(\n      [\"uint256\", \"uint256\", \"bytes32\", \"uint256\"],\n      [webAuthnData.pubKeyX, webAuthnData.pubKeyY, authenticatorIdHash, index]\n    )\n  );\n  const validatorInitData = (0,viem__WEBPACK_IMPORTED_MODULE_13__.encodeAbiParameters)(\n    [\n      {\n        components: [\n          { name: \"pubKeyX\", type: \"uint256\" },\n          { name: \"pubKeyY\", type: \"uint256\" }\n        ],\n        type: \"tuple\"\n      },\n      { type: \"bytes32\" }\n    ],\n    [webAuthnData, authenticatorIdHash]\n  );\n  const registryConfig = {\n    attesters: [attester],\n    registry,\n    threshold: 1n\n  };\n  const bootstrapCall = (0,viem__WEBPACK_IMPORTED_MODULE_14__.encodeFunctionData)({\n    abi: [\n      {\n        inputs: [\n          { name: \"validator\", type: \"address\" },\n          { name: \"validatorInitData\", type: \"bytes\" },\n          {\n            components: [\n              { name: \"registry\", type: \"address\" },\n              { name: \"attesters\", type: \"address[]\" },\n              { name: \"threshold\", type: \"uint8\" }\n            ],\n            name: \"registryConfig\",\n            type: \"tuple\"\n          }\n        ],\n        name: \"initNexusWithSingleValidator\",\n        type: \"function\"\n      }\n    ],\n    args: [webAuthnValidator, validatorInitData, registryConfig],\n    functionName: \"initNexusWithSingleValidator\"\n  });\n  const initData = (0,viem__WEBPACK_IMPORTED_MODULE_13__.encodeAbiParameters)(\n    [{ type: \"address\" }, { type: \"bytes\" }],\n    [bootstrapper, bootstrapCall]\n  );\n  return predictProxyAddress(\n    accountImplementation,\n    salt,\n    initData,\n    factoryAddress\n  );\n}\nfunction predictProxyAddress(implementation, salt, initData, deployer) {\n  const initializeCall = (0,viem__WEBPACK_IMPORTED_MODULE_14__.encodeFunctionData)({\n    abi: [\n      {\n        inputs: [{ name: \"data\", type: \"bytes\" }],\n        name: \"initializeAccount\",\n        type: \"function\"\n      }\n    ],\n    args: [initData],\n    functionName: \"initializeAccount\"\n  });\n  const constructorArgs = (0,viem__WEBPACK_IMPORTED_MODULE_13__.encodeAbiParameters)(\n    [{ type: \"address\" }, { type: \"bytes\" }],\n    [implementation, initializeCall]\n  );\n  const nexusProxyCreationCode = \"0x60806040526102c8803803806100148161018c565b92833981016040828203126101885781516001600160a01b03811692909190838303610188576020810151906001600160401b03821161018857019281601f8501121561018857835161006e610069826101c5565b61018c565b9481865260208601936020838301011161018857815f926020809301865e8601015260017f90b772c2cb8a51aa7a8a65fc23543c6d022d5b3f8e2b92eed79fba7eef8293005d823b15610176577f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc80546001600160a01b031916821790557fbc7cd75a20ee27fd9adebab32041f755214dbc6bffa90cc0225b39da2e5c2d3b5f80a282511561015e575f8091610146945190845af43d15610156573d91610137610069846101c5565b9283523d5f602085013e6101e0565b505b6040516089908161023f8239f35b6060916101e0565b50505034156101485763b398979f60e01b5f5260045ffd5b634c9c8ce360e01b5f5260045260245ffd5b5f80fd5b6040519190601f01601f191682016001600160401b038111838210176101b157604052565b634e487b7160e01b5f52604160045260245ffd5b6001600160401b0381116101b157601f01601f191660200190565b9061020457508051156101f557805190602001fd5b63d6bda27560e01b5f5260045ffd5b81511580610235575b610215575090565b639996b31560e01b5f9081526001600160a01b0391909116600452602490fd5b50803b1561020d56fe608060405236156051577f360894a13ba1a3210667c828492db98dca3e2076cc3735a920a3ca505d382bbc545f9081906001600160a01b0316368280378136915af43d5f803e15604d573d5ff35b3d5ffd5b00fea264697066735822122041b5f70a351952142223f22504ca7b4e6d975f3a302d114ff820442fcf815ac264736f6c634300081b0033\";\n  const initCodeHash = (0,viem__WEBPACK_IMPORTED_MODULE_11__.keccak256)(\n    (0,viem__WEBPACK_IMPORTED_MODULE_12__.encodePacked)([\"bytes\", \"bytes\"], [nexusProxyCreationCode, constructorArgs])\n  );\n  return (0,viem__WEBPACK_IMPORTED_MODULE_15__.getCreate2Address)({\n    bytecodeHash: initCodeHash,\n    from: deployer,\n    salt\n  });\n}\n\n// src/utils/ens.ts\nasync function reverseResolveEns(address) {\n  try {\n    const response = await fetch(`${ENS_API_URL}/reverse/${address}`);\n    if (!response.ok) {\n      throw new Error(\n        `ENS API request failed: ${response.status} ${response.statusText}`\n      );\n    }\n    const data = await response.json();\n    return {\n      address: data.address,\n      name: data.name || null\n    };\n  } catch (error) {\n    console.error(\"Failed to resolve ENS name:\", error);\n    return {\n      address,\n      name: null\n    };\n  }\n}\n\n// src/utils/popup.ts\n\nvar POPUP_WIDTH2 = 420;\nvar POPUP_HEIGHT2 = 650;\nvar openPopup = (url) => {\n  const left = (window.innerWidth - POPUP_WIDTH2) / 2 + window.screenX;\n  const top = (window.innerHeight - POPUP_HEIGHT2) / 2 + window.screenY;\n  const popupId = `wallet_${window?.crypto?.randomUUID()}`;\n  const popup = window.open(\n    url,\n    popupId,\n    `width=${POPUP_WIDTH2}, height=${POPUP_HEIGHT2}, left=${left}, top=${top}`\n  );\n  popup?.focus();\n  if (!popup) {\n    throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.rpcErrors.internal(\"Pop up window failed to open\");\n  }\n  return popup;\n};\nvar closePopup = (popup) => {\n  if (popup && !popup.closed) {\n    popup.opener?.focus();\n    popup.close();\n  }\n};\n\n// src/utils/strings.ts\nvar hexStringFromNumber = (num) => {\n  return `0x${BigInt(num).toString(16)}`;\n};\nvar safeJsonStringify = (obj) => JSON.stringify(\n  obj,\n  (_, value) => typeof value === \"bigint\" ? value.toString() + \"n\" : value,\n  2\n);\n\n// src/communicator.ts\nvar Communicator = class {\n  constructor({ appMetadata, onDisconnectCallback }) {\n    this.popup = null;\n    this.listeners = /* @__PURE__ */ new Map();\n    // posts a message to the popup window\n    this.postMessage = async (message) => {\n      const popup = await this.waitForPopupLoaded();\n      popup.postMessage(message, this.url.origin);\n    };\n    // posts a request to the popup window and waits for a response\n    this.postRequestAndWaitForResponse = async (request) => {\n      const responsePromise = this.onMessage(\n        ({ requestId }) => requestId === request.requestId\n      );\n      this.postMessage(request);\n      return await responsePromise;\n    };\n    // listens for messages from the popup window that match a given predicate\n    this.onMessage = (predicate) => {\n      return new Promise((resolve, reject) => {\n        const listener = (event) => {\n          if (event.origin !== this.url.origin) return;\n          const message = event.data;\n          if (predicate(message)) {\n            resolve(message);\n            window.removeEventListener(\"message\", listener);\n            this.listeners.delete(listener);\n          }\n        };\n        window.addEventListener(\"message\", listener);\n        this.listeners.set(listener, { reject });\n      });\n    };\n    // closes the popup, rejects all requests and clears event listeners\n    this.onRequestCancelled = () => {\n      closePopup(this.popup);\n      this.popup = null;\n      this.listeners.forEach(({ reject }, listener) => {\n        reject(_metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.providerErrors.userRejectedRequest());\n        window.removeEventListener(\"message\", listener);\n      });\n      this.listeners.clear();\n    };\n    // waits for the popup window to fully load and then sends a version message\n    this.waitForPopupLoaded = () => {\n      if (this.popup && !this.popup.closed) {\n        this.popup.focus();\n        return Promise.resolve(this.popup);\n      }\n      this.popup = openPopup(this.url);\n      this.onMessage(\n        ({ event }) => event === \"POPUP_UNLOADED\" /* POPUP_UNLOADED */\n      ).then(this.onRequestCancelled).catch(() => {\n      });\n      this.onMessage(\n        ({ event }) => event === \"SDK_DISCONNECT\" /* SDK_DISCONNECT */\n      ).then(() => {\n        this.onDisconnectCallback?.();\n        this.onRequestCancelled();\n      }).catch(() => {\n      });\n      return this.onMessage(\n        ({ event }) => event === \"POPUP_LOADED\" /* POPUP_LOADED */\n      ).then((message) => {\n        this.postMessage({\n          chainId: DEFAULT_CHAIN_ID,\n          data: {\n            appMetadata: this.appMetadata,\n            origin: window.location.origin,\n            sdkVersion: SDK_VERSION\n          },\n          event: \"POPUP_APP_CONTEXT\" /* POPUP_APP_CONTEXT */,\n          origin: window.location.origin,\n          requestId: message.requestId\n        });\n      }).then(() => {\n        if (!this.popup) throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.rpcErrors.internal();\n        return this.popup;\n      });\n    };\n    this.url = new URL(SDK_BACKEND_URL);\n    this.appMetadata = appMetadata;\n    this.onDisconnectCallback = onDisconnectCallback;\n  }\n};\n\n// src/provider/provider.ts\n\n\n// src/storage/storage.ts\nvar memoryStorage = {};\nvar GeminiStorage = class {\n  constructor({\n    scope = \"@gemini\",\n    module = \"wallet\"\n  } = {}) {\n    this.scope = scope;\n    this.module = module;\n  }\n  scopedKey(key) {\n    return `${this.scope}.${this.module}.${key}`;\n  }\n  async storeObject(key, item) {\n    const json = safeJsonStringify(item);\n    await this.setItem(key, json);\n  }\n  async loadObject(key, fallback) {\n    const item = await this.getItem(key);\n    if (!item) {\n      await this.storeObject(key, fallback);\n      return fallback;\n    }\n    try {\n      return JSON.parse(item);\n    } catch (error) {\n      console.error(`Error parsing JSON for key ${key}:`, error);\n      return fallback;\n    }\n  }\n  // eslint-disable-next-line require-await\n  async setItem(key, value) {\n    const scoped = this.scopedKey(key);\n    try {\n      localStorage.setItem(scoped, value);\n    } catch (e) {\n      console.warn(\"localStorage not available, using memory storage\", e);\n      memoryStorage[scoped] = value;\n    }\n  }\n  // eslint-disable-next-line require-await\n  async getItem(key) {\n    const scoped = this.scopedKey(key);\n    try {\n      return localStorage.getItem(scoped);\n    } catch (e) {\n      console.warn(\"localStorage not available, using memory storage\", e);\n      return memoryStorage[scoped] || null;\n    }\n  }\n  // eslint-disable-next-line require-await\n  async removeItem(key) {\n    const scoped = this.scopedKey(key);\n    try {\n      localStorage.removeItem(scoped);\n    } catch (e) {\n      console.warn(\"localStorage not available, using memory storage\", e);\n      delete memoryStorage[scoped];\n    }\n  }\n  async removeItems(keys) {\n    await Promise.all(keys.map((key) => this.removeItem(key)));\n  }\n};\n\n// src/storage/storageInterface.ts\nvar STORAGE_ETH_ACCOUNTS_KEY = \"eth-accounts\";\nvar STORAGE_ETH_ACTIVE_CHAIN_KEY = \"eth-active-chain\";\nvar STORAGE_PASSKEY_CREDENTIAL_KEY = \"passkey-credential\";\nvar STORAGE_PRESERVED_PASSKEY_CREDENTIALS_KEY = \"preserved-passkey-credentials\";\nvar STORAGE_SMART_ACCOUNT_KEY = \"smart-account\";\nvar STORAGE_SETTINGS_KEY = \"settings\";\nvar STORAGE_WC_REQUESTS_KEY = \"wc-requests\";\n\n// src/wallets/wallet.ts\nfunction isChainSupportedByGeminiSw(chainId) {\n  return SUPPORTED_CHAIN_IDS.includes(\n    chainId\n  );\n}\nvar GeminiWallet = class {\n  constructor({\n    appMetadata,\n    chain,\n    onDisconnectCallback,\n    storage\n  }) {\n    this.accounts = [];\n    this.chain = { id: DEFAULT_CHAIN_ID };\n    this.communicator = new Communicator({\n      appMetadata,\n      onDisconnectCallback\n    });\n    this.storage = storage || new GeminiStorage();\n    const fallbackChainId = chain?.id ?? DEFAULT_CHAIN_ID;\n    const fallbackRpcUrl = chain?.rpcUrl ?? getDefaultRpcUrl(fallbackChainId);\n    const defaultChain = {\n      id: fallbackChainId,\n      rpcUrl: fallbackRpcUrl\n    };\n    this.initPromise = this.initializeFromStorage(defaultChain);\n  }\n  async initializeFromStorage(defaultChain) {\n    const fallbackChain = {\n      ...defaultChain,\n      rpcUrl: defaultChain.rpcUrl || getDefaultRpcUrl(defaultChain.id)\n    };\n    const [storedChain, storedAccounts] = await Promise.all([\n      this.storage.loadObject(\n        STORAGE_ETH_ACTIVE_CHAIN_KEY,\n        fallbackChain\n      ),\n      this.storage.loadObject(\n        STORAGE_ETH_ACCOUNTS_KEY,\n        this.accounts\n      )\n    ]);\n    this.chain = {\n      ...storedChain,\n      rpcUrl: storedChain.rpcUrl || getDefaultRpcUrl(storedChain.id)\n    };\n    this.accounts = storedAccounts;\n  }\n  async ensureInitialized() {\n    await this.initPromise;\n  }\n  async connect() {\n    await this.ensureInitialized();\n    const response = await this.sendMessageToPopup({\n      chainId: this.chain.id,\n      event: \"SDK_CONNECT\" /* SDK_CONNECT */,\n      origin: window.location.origin\n    });\n    this.accounts = response.data.address ? [response.data.address] : [];\n    await this.storage.storeObject(STORAGE_ETH_ACCOUNTS_KEY, this.accounts);\n    return this.accounts;\n  }\n  async disconnect() {\n    await this.ensureInitialized();\n    this.accounts = [];\n    await this.storage.storeObject(STORAGE_ETH_ACCOUNTS_KEY, this.accounts);\n  }\n  async switchChain({ id }) {\n    await this.ensureInitialized();\n    if (isChainSupportedByGeminiSw(id)) {\n      this.chain = {\n        id,\n        rpcUrl: getDefaultRpcUrl(id)\n      };\n      await this.storage.storeObject(STORAGE_ETH_ACTIVE_CHAIN_KEY, this.chain);\n      return null;\n    }\n    const response = await this.sendMessageToPopup({\n      chainId: this.chain.id,\n      data: id,\n      event: \"SDK_SWITCH_CHAIN\" /* SDK_SWITCH_CHAIN */,\n      origin: window.location.origin\n    });\n    return response.data.error ?? \"Unsupported chain.\";\n  }\n  async sendTransaction(txData) {\n    await this.ensureInitialized();\n    const response = await this.sendMessageToPopup({\n      chainId: this.chain.id,\n      data: txData,\n      event: \"SDK_SEND_TRANSACTION\" /* SDK_SEND_TRANSACTION */,\n      origin: window.location.origin\n    });\n    return response.data;\n  }\n  async signData({\n    message\n  }) {\n    await this.ensureInitialized();\n    const response = await this.sendMessageToPopup({\n      chainId: this.chain.id,\n      data: { message },\n      event: \"SDK_SIGN_DATA\" /* SDK_SIGN_DATA */,\n      origin: window.location.origin\n    });\n    return response.data;\n  }\n  async signTypedData({\n    message,\n    types,\n    primaryType,\n    domain\n  }) {\n    await this.ensureInitialized();\n    const response = await this.sendMessageToPopup({\n      chainId: this.chain.id,\n      data: {\n        domain,\n        message,\n        primaryType,\n        types\n      },\n      event: \"SDK_SIGN_TYPED_DATA\" /* SDK_SIGN_TYPED_DATA */,\n      origin: window.location.origin\n    });\n    return response.data;\n  }\n  async openSettings() {\n    await this.ensureInitialized();\n    await this.sendMessageToPopup({\n      chainId: this.chain.id,\n      data: {},\n      event: \"SDK_OPEN_SETTINGS\" /* SDK_OPEN_SETTINGS */,\n      origin: window.location.origin\n    });\n  }\n  sendMessageToPopup(request) {\n    return this.communicator.postRequestAndWaitForResponse({\n      ...request,\n      requestId: window?.crypto?.randomUUID()\n    });\n  }\n};\n\n// src/provider/provider.utils.ts\n\n\nvar fetchRpcRequest = async (request, rpcUrl) => {\n  const requestBody = {\n    ...request,\n    id: window?.crypto?.randomUUID(),\n    jsonrpc: \"2.0\"\n  };\n  const res = await window.fetch(rpcUrl, {\n    body: JSON.stringify(requestBody),\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    method: \"POST\",\n    mode: \"cors\"\n  });\n  const { result, error } = await res.json();\n  if (error) throw error;\n  return result;\n};\nfunction validateRpcRequestArgs(args) {\n  if (!args || typeof args !== \"object\" || Array.isArray(args)) {\n    throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.rpcErrors.invalidParams({\n      message: \"Expected a single, non-array, object argument.\"\n    });\n  }\n  const { method, params } = args;\n  if (typeof method !== \"string\" || method.length === 0) {\n    throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.rpcErrors.invalidParams({\n      message: \"'args.method' must be a non-empty string.\"\n    });\n  }\n  if (params !== void 0 && !Array.isArray(params) && (typeof params !== \"object\" || params === null)) {\n    throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.rpcErrors.invalidParams({\n      message: \"'args.params' must be an object or array if provided.\"\n    });\n  }\n}\nfunction convertSendValuesToBigInt(tx) {\n  const FIELDS_TO_NORMALIZE = [\"value\", \"gas\", \"gasPrice\", \"maxPriorityFeePerGas\", \"maxFeePerGas\"];\n  const normalized = { ...tx };\n  for (const field of FIELDS_TO_NORMALIZE) {\n    if (!(field in tx)) continue;\n    const value = tx[field];\n    if (typeof value === \"bigint\") continue;\n    if ((0,viem__WEBPACK_IMPORTED_MODULE_17__.isHex)(value)) {\n      normalized[field] = BigInt(value);\n    }\n  }\n  return normalized;\n}\n\n// src/provider/provider.ts\nvar GeminiWalletProvider = class extends ProviderEventEmitter {\n  constructor(providerConfig) {\n    super();\n    this.wallet = null;\n    this.config = providerConfig;\n    const userDisconnectCallback = providerConfig.onDisconnectCallback;\n    this.wallet = new GeminiWallet({\n      ...providerConfig,\n      onDisconnectCallback: () => {\n        userDisconnectCallback?.();\n        this.disconnect();\n      }\n    });\n  }\n  async request(args) {\n    try {\n      validateRpcRequestArgs(args);\n      if (!this.wallet?.accounts?.length) {\n        switch (args.method) {\n          case \"eth_requestAccounts\": {\n            if (!this.wallet) {\n              const userDisconnectCallback = this.config.onDisconnectCallback;\n              this.wallet = new GeminiWallet({\n                ...this.config,\n                onDisconnectCallback: () => {\n                  userDisconnectCallback?.();\n                  this.disconnect();\n                }\n              });\n            }\n            await this.wallet.connect();\n            this.emit(\"accountsChanged\", this.wallet.accounts);\n            break;\n          }\n          case \"net_version\":\n            return DEFAULT_CHAIN_ID;\n          case \"eth_chainId\":\n            return hexStringFromNumber(DEFAULT_CHAIN_ID);\n          default: {\n            throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.providerErrors.unauthorized();\n          }\n        }\n      }\n      let response;\n      let requestParams;\n      switch (args.method) {\n        case \"eth_requestAccounts\":\n        case \"eth_accounts\":\n          response = this.wallet.accounts;\n          break;\n        case \"net_version\":\n          response = this.wallet.chain.id;\n          break;\n        case \"eth_chainId\":\n          response = hexStringFromNumber(this.wallet.chain.id);\n          break;\n        case \"personal_sign\":\n        case \"wallet_sign\":\n          requestParams = args.params;\n          response = await this.wallet.signData({\n            account: requestParams[1],\n            message: requestParams[0]\n          });\n          if (response.error) {\n            throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.rpcErrors.transactionRejected(response.error);\n          } else {\n            response = response.hash;\n          }\n          break;\n        case \"eth_sendTransaction\":\n        case \"wallet_sendTransaction\":\n          requestParams = args.params;\n          requestParams = convertSendValuesToBigInt(requestParams[0]);\n          response = await this.wallet.sendTransaction(requestParams);\n          if (response.error) {\n            throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.rpcErrors.transactionRejected(response.error);\n          } else {\n            response = response.hash;\n          }\n          break;\n        case \"wallet_switchEthereumChain\": {\n          const rawParams = args.params;\n          let chainId;\n          if (Array.isArray(rawParams) && rawParams[0]?.chainId) {\n            chainId = parseInt(rawParams[0].chainId, 16);\n          } else if (rawParams && typeof rawParams === \"object\" && \"id\" in rawParams && Number.isInteger(rawParams.id)) {\n            chainId = rawParams.id;\n          } else {\n            throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.rpcErrors.invalidParams(\n              \"Invalid chain id argument. Expected [{ chainId: hex_string }] or { id: number }.\"\n            );\n          }\n          response = await this.wallet.switchChain({ id: chainId });\n          if (response) {\n            throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.providerErrors.custom({ code: 4902, message: response });\n          }\n          await this.emit(\"chainChanged\", hexStringFromNumber(chainId));\n          break;\n        }\n        case \"eth_signTypedData_v1\":\n        case \"eth_signTypedData_v2\":\n        case \"eth_signTypedData_v3\":\n        case \"eth_signTypedData_v4\":\n        case \"eth_signTypedData\": {\n          requestParams = args.params;\n          const signedTypedDataParams = JSON.parse(\n            requestParams[1]\n          );\n          response = await this.wallet.signTypedData({\n            account: requestParams[0],\n            domain: signedTypedDataParams.domain,\n            message: signedTypedDataParams.message,\n            primaryType: signedTypedDataParams.primaryType,\n            types: signedTypedDataParams.types\n          });\n          if (response.error) {\n            throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.rpcErrors.transactionRejected(response.error);\n          } else {\n            response = response.hash;\n          }\n          break;\n        }\n        // TODO: not yet implemented or unclear if we support\n        case \"eth_ecRecover\":\n        case \"eth_subscribe\":\n        case \"eth_unsubscribe\":\n        case \"personal_ecRecover\":\n        case \"eth_signTransaction\":\n        case \"wallet_watchAsset\":\n        case \"wallet_sendCalls\":\n        case \"wallet_getCallsStatus\":\n        case \"wallet_getCapabilities\":\n        case \"wallet_showCallsStatus\":\n        case \"wallet_grantPermissions\":\n          throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.rpcErrors.methodNotSupported(\"Not yet implemented.\");\n        // not supported\n        case \"eth_sign\":\n        case \"eth_coinbase\":\n        case \"wallet_addEthereumChain\":\n          throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.rpcErrors.methodNotSupported();\n        // call rpc directly for everything else\n        default:\n          if (!this.wallet.chain.rpcUrl)\n            throw _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_16__.rpcErrors.internal(\n              `RPC URL missing for current chain (${this.wallet.chain.id})`\n            );\n          return fetchRpcRequest(args, this.wallet.chain.rpcUrl);\n      }\n      return response;\n    } catch (error) {\n      const { code } = error;\n      if (code === _metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_18__.errorCodes.provider.unauthorized) this.disconnect();\n      return Promise.reject((0,_metamask_rpc_errors__WEBPACK_IMPORTED_MODULE_19__.serializeError)(error));\n    }\n  }\n  // custom wallet function to open settings page\n  async openSettings() {\n    await this.wallet?.openSettings();\n  }\n  async disconnect() {\n    if (this.wallet) {\n      const storage = this.config.storage || new GeminiStorage();\n      await storage.removeItem(STORAGE_ETH_ACCOUNTS_KEY);\n      await storage.removeItem(STORAGE_ETH_ACTIVE_CHAIN_KEY);\n    }\n    this.wallet = null;\n    this.config.onDisconnectCallback?.();\n    await this.emit(\"disconnect\", \"User initiated disconnection\");\n    await this.emit(\"accountsChanged\", []);\n  }\n};\n\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGdlbWluaS13YWxsZXQvY29yZS9kaXN0L2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQytFOztBQUUvRTtBQVlxQjs7QUFFckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssZ0RBQU8sTUFBTSxnREFBTztBQUN6QixLQUFLLGlEQUFRLE1BQU0saURBQVE7QUFDM0IsS0FBSyxpREFBUSxNQUFNLGlEQUFRO0FBQzNCLEtBQUssNkNBQUksTUFBTSw2Q0FBSTtBQUNuQixLQUFLLGdEQUFPLE1BQU0sZ0RBQU87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MUI7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDREQUFVO0FBQzVCLG9EQUFvRCxxQkFBcUI7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ04sY0FBYyxPQUFPO0FBQ3JCLG1CQUFtQiw2REFBVTtBQUM3Qiw0QkFBNEIscUVBQWM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdUNFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZW9xdWVzdC1mcm9udGVuZC8uL25vZGVfbW9kdWxlcy9AZ2VtaW5pLXdhbGxldC9jb3JlL2Rpc3QvaW5kZXguanM/OGYwMSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvY29tbXVuaWNhdG9yLnRzXG5pbXBvcnQgeyBwcm92aWRlckVycm9ycywgcnBjRXJyb3JzIGFzIHJwY0Vycm9yczIgfSBmcm9tIFwiQG1ldGFtYXNrL3JwYy1lcnJvcnNcIjtcblxuLy8gc3JjL2NvbnN0YW50cy50c1xuaW1wb3J0IHtcbiAgYXJiaXRydW0sXG4gIGFyYml0cnVtU2Vwb2xpYSxcbiAgYmFzZSxcbiAgYmFzZVNlcG9saWEsXG4gIG1haW5uZXQsXG4gIG9wdGltaXNtLFxuICBvcHRpbWlzbVNlcG9saWEsXG4gIHBvbHlnb24sXG4gIHBvbHlnb25BbW95LFxuICBzZXBvbGlhXG59IGZyb20gXCJ2aWVtL2NoYWluc1wiO1xuXG4vLyBwYWNrYWdlLmpzb25cbnZhciBwYWNrYWdlX2RlZmF1bHQgPSB7XG4gIG5hbWU6IFwiQGdlbWluaS13YWxsZXQvY29yZVwiLFxuICB2ZXJzaW9uOiBcIjAuMy4xXCIsXG4gIGRlc2NyaXB0aW9uOiBcIkNvcmUgU0RLIGZvciBHZW1pbmkgV2FsbGV0IGludGVncmF0aW9uIHdpdGggcG9wdXAgY29tbXVuaWNhdGlvblwiLFxuICBtYWluOiBcIi4vZGlzdC9pbmRleC5janNcIixcbiAgdHlwZXM6IFwiLi9kaXN0L2luZGV4LmQudHNcIixcbiAgdHlwZTogXCJtb2R1bGVcIixcbiAgcmVwb3NpdG9yeToge1xuICAgIHR5cGU6IFwiZ2l0XCIsXG4gICAgdXJsOiBcImdpdCtodHRwczovL2dpdGh1Yi5jb20vZ2VtaW5pL2dlbWluaS13YWxsZXQtY29yZS5naXRcIlxuICB9LFxuICBob21lcGFnZTogXCJodHRwczovL2tleXMuZ2VtaW5pLmNvbVwiLFxuICBidWdzOiB7XG4gICAgdXJsOiBcImh0dHBzOi8vZ2l0aHViLmNvbS9nZW1pbmkvZ2VtaW5pLXdhbGxldC1jb3JlL2lzc3Vlc1wiXG4gIH0sXG4gIGxpY2Vuc2U6IFwiTUlUXCIsXG4gIGF1dGhvcjogXCJHZW1pbmlcIixcbiAgZmlsZXM6IFtcbiAgICBcImRpc3RcIixcbiAgICBcInNyY1wiLFxuICAgIFwiUkVBRE1FLm1kXCIsXG4gICAgXCJMSUNFTlNFXCJcbiAgXSxcbiAgZXhwb3J0czoge1xuICAgIFwiLlwiOiB7XG4gICAgICB0eXBlczogXCIuL2Rpc3QvaW5kZXguZC50c1wiLFxuICAgICAgaW1wb3J0OiBcIi4vZGlzdC9pbmRleC5qc1wiLFxuICAgICAgcmVxdWlyZTogXCIuL2Rpc3QvaW5kZXguY2pzXCJcbiAgICB9LFxuICAgIFwiLi9wYWNrYWdlLmpzb25cIjogXCIuL3BhY2thZ2UuanNvblwiXG4gIH0sXG4gIHNjcmlwdHM6IHtcbiAgICBidWlsZDogXCJkb3RlbnYgLWUgLmVudi5wcm9kdWN0aW9uIC0tIHRzdXBcIixcbiAgICBkZXY6IFwiZG90ZW52IC1lIC5lbnYubG9jYWwgLS0gdHN1cCAtLXdhdGNoXCIsXG4gICAgdHlwZWNoZWNrOiBcInRzYyAtLW5vRW1pdFwiLFxuICAgIGxpbnQ6IFwiZXNsaW50IC4vc3JjXCIsXG4gICAgXCJsaW50OmNpXCI6IFwiZXNsaW50IC0tbWF4LXdhcm5pbmdzIDAgLi9zcmNcIixcbiAgICBcImxpbnQ6Zml4XCI6IFwiZXNsaW50IC4vc3JjIC0tZml4XCIsXG4gICAgdGVzdDogXCJidW4gdGVzdFwiXG4gIH0sXG4gIGRlcGVuZGVuY2llczoge1xuICAgIFwiQG1ldGFtYXNrL3JwYy1lcnJvcnNcIjogXCI3LjAuMlwiLFxuICAgIGV2ZW50ZW1pdHRlcjM6IFwiNS4wLjFcIlxuICB9LFxuICBkZXZEZXBlbmRlbmNpZXM6IHtcbiAgICBcIkBlc2xpbnQvZXNsaW50cmNcIjogXCIzLjMuMVwiLFxuICAgIFwiQGVzbGludC9qc1wiOiBcIjkuMzMuMFwiLFxuICAgIFwiQG5leHQvZXNsaW50LXBsdWdpbi1uZXh0XCI6IFwiMTUuNC43XCIsXG4gICAgXCJAdHlwZXMvbm9kZVwiOiBcIjIyLjEzLjBcIixcbiAgICBcImRvdGVudi1jbGlcIjogXCIxMC4wLjBcIixcbiAgICBcImVzYnVpbGQtcGx1Z2luLXJlcGxhY2VcIjogXCIxLjQuMFwiLFxuICAgIGVzbGludDogXCI5LjMzLjBcIixcbiAgICBcImVzbGludC1jb25maWctcHJldHRpZXJcIjogXCIxMC4xLjhcIixcbiAgICBcImVzbGludC1jb25maWctdHVyYm9cIjogXCIyLjUuNlwiLFxuICAgIFwiZXNsaW50LXBsdWdpbi1pbXBvcnRcIjogXCIyLjMyLjBcIixcbiAgICBcImVzbGludC1wbHVnaW4tanN4LWExMXlcIjogXCI2LjEwLjJcIixcbiAgICBcImVzbGludC1wbHVnaW4tb25seS13YXJuXCI6IFwiMS4xLjBcIixcbiAgICBcImVzbGludC1wbHVnaW4tcHJldHRpZXJcIjogXCI1LjUuNFwiLFxuICAgIFwiZXNsaW50LXBsdWdpbi1yZWFjdFwiOiBcIjcuMzcuNVwiLFxuICAgIFwiZXNsaW50LXBsdWdpbi1yZWFjdC1ob29rc1wiOiBcIjUuMi4wXCIsXG4gICAgXCJlc2xpbnQtcGx1Z2luLXNpbXBsZS1pbXBvcnQtc29ydFwiOiBcIjEyLjEuMVwiLFxuICAgIFwiZXNsaW50LXBsdWdpbi1zb3J0LWtleXMtZml4XCI6IFwiMS4xLjJcIixcbiAgICBnbG9iYWxzOiBcIjE2LjMuMFwiLFxuICAgIHByZXR0aWVyOiBcIjMuNi4yXCIsXG4gICAgdHN1cDogXCI4LjQuMFwiLFxuICAgIHR5cGVzY3JpcHQ6IFwiNS41LjNcIixcbiAgICBcInR5cGVzY3JpcHQtZXNsaW50XCI6IFwiOC40MC4wXCIsXG4gICAgdml0ZXN0OiBcIjMuMi40XCJcbiAgfSxcbiAgcGVlckRlcGVuZGVuY2llczoge1xuICAgIHZpZW06IFwiPj0yLjAuMFwiXG4gIH0sXG4gIGtleXdvcmRzOiBbXG4gICAgXCJnZW1pbmlcIixcbiAgICBcIndhbGxldFwiLFxuICAgIFwic2RrXCIsXG4gICAgXCJldGhlcmV1bVwiLFxuICAgIFwid2ViM1wiLFxuICAgIFwiY3J5cHRvXCJcbiAgXSxcbiAgbW9kdWxlOiBcIi4vZGlzdC9pbmRleC5qc1wiXG59O1xuXG4vLyBzcmMvY29uc3RhbnRzLnRzXG52YXIgREVGQVVMVF9CQUNLRU5EX1VSTCA9IFwiaHR0cHM6Ly9rZXlzLmdlbWluaS5jb21cIjtcbnZhciBTREtfQkFDS0VORF9VUkwgPSB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBcInVuZGVmaW5lZFwiIHx8IERFRkFVTFRfQkFDS0VORF9VUkw7XG52YXIgRU5TX0FQSV9VUkwgPSBcImh0dHBzOi8vaG9yaXpvbi1hcGkuZ2VtaW5pLmNvbS9hcGkvZW5zXCI7XG52YXIgU0RLX1ZFUlNJT04gPSBwYWNrYWdlX2RlZmF1bHQudmVyc2lvbjtcbnZhciBERUZBVUxUX0NIQUlOX0lEID0gNDIxNjE7XG52YXIgTUFJTk5FVF9DSEFJTl9JRFMgPSB7XG4gIEFSQklUUlVNX09ORTogNDIxNjEsXG4gIEJBU0U6IDg0NTMsXG4gIEVUSEVSRVVNOiAxLFxuICBPUF9NQUlOTkVUOiAxMCxcbiAgUE9MWUdPTjogMTM3XG59O1xudmFyIFRFU1RORVRfQ0hBSU5fSURTID0ge1xuICBBUkJJVFJVTV9TRVBPTElBOiA0MjE2MTQsXG4gIEJBU0VfU0VQT0xJQTogODQ1MzIsXG4gIE9QX1NFUE9MSUE6IDExMTU1NDIwLFxuICBQT0xZR09OX0FNT1k6IDgwMDAyLFxuICBTRVBPTElBOiAxMTE1NTExMVxufTtcbnZhciBTVVBQT1JURURfQ0hBSU5fSURTID0gW1xuICAuLi5PYmplY3QudmFsdWVzKE1BSU5ORVRfQ0hBSU5fSURTKSxcbiAgLi4uT2JqZWN0LnZhbHVlcyhURVNUTkVUX0NIQUlOX0lEUylcbl07XG5mdW5jdGlvbiBnZXREZWZhdWx0UnBjVXJsKGNoYWluSWQpIHtcbiAgY29uc3QgY2hhaW5NYXAgPSB7XG4gICAgW21haW5uZXQuaWRdOiBtYWlubmV0LnJwY1VybHMuZGVmYXVsdC5odHRwWzBdLFxuICAgIFthcmJpdHJ1bS5pZF06IGFyYml0cnVtLnJwY1VybHMuZGVmYXVsdC5odHRwWzBdLFxuICAgIFtvcHRpbWlzbS5pZF06IG9wdGltaXNtLnJwY1VybHMuZGVmYXVsdC5odHRwWzBdLFxuICAgIFtiYXNlLmlkXTogYmFzZS5ycGNVcmxzLmRlZmF1bHQuaHR0cFswXSxcbiAgICBbcG9seWdvbi5pZF06IHBvbHlnb24ucnBjVXJscy5kZWZhdWx0Lmh0dHBbMF0sXG4gICAgW3NlcG9saWEuaWRdOiBzZXBvbGlhLnJwY1VybHMuZGVmYXVsdC5odHRwWzBdLFxuICAgIFthcmJpdHJ1bVNlcG9saWEuaWRdOiBhcmJpdHJ1bVNlcG9saWEucnBjVXJscy5kZWZhdWx0Lmh0dHBbMF0sXG4gICAgW29wdGltaXNtU2Vwb2xpYS5pZF06IG9wdGltaXNtU2Vwb2xpYS5ycGNVcmxzLmRlZmF1bHQuaHR0cFswXSxcbiAgICBbYmFzZVNlcG9saWEuaWRdOiBiYXNlU2Vwb2xpYS5ycGNVcmxzLmRlZmF1bHQuaHR0cFswXSxcbiAgICBbcG9seWdvbkFtb3kuaWRdOiBwb2x5Z29uQW1veS5ycGNVcmxzLmRlZmF1bHQuaHR0cFswXVxuICB9O1xuICByZXR1cm4gY2hhaW5NYXBbY2hhaW5JZF07XG59XG52YXIgUE9QVVBfV0lEVEggPSA0MjA7XG52YXIgUE9QVVBfSEVJR0hUID0gNjUwO1xuXG4vLyBzcmMvdHlwZXMudHNcbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gXCJldmVudGVtaXR0ZXIzXCI7XG52YXIgR2VtaW5pU2RrRXZlbnQgPSAvKiBAX19QVVJFX18gKi8gKChHZW1pbmlTZGtFdmVudDIpID0+IHtcbiAgR2VtaW5pU2RrRXZlbnQyW1wiUE9QVVBfTE9BREVEXCJdID0gXCJQT1BVUF9MT0FERURcIjtcbiAgR2VtaW5pU2RrRXZlbnQyW1wiUE9QVVBfVU5MT0FERURcIl0gPSBcIlBPUFVQX1VOTE9BREVEXCI7XG4gIEdlbWluaVNka0V2ZW50MltcIlBPUFVQX0FQUF9DT05URVhUXCJdID0gXCJQT1BVUF9BUFBfQ09OVEVYVFwiO1xuICBHZW1pbmlTZGtFdmVudDJbXCJTREtfQ09OTkVDVFwiXSA9IFwiU0RLX0NPTk5FQ1RcIjtcbiAgR2VtaW5pU2RrRXZlbnQyW1wiU0RLX0RJU0NPTk5FQ1RcIl0gPSBcIlNES19ESVNDT05ORUNUXCI7XG4gIEdlbWluaVNka0V2ZW50MltcIlNES19TRU5EX1RSQU5TQUNUSU9OXCJdID0gXCJTREtfU0VORF9UUkFOU0FDVElPTlwiO1xuICBHZW1pbmlTZGtFdmVudDJbXCJTREtfU0lHTl9EQVRBXCJdID0gXCJTREtfU0lHTl9EQVRBXCI7XG4gIEdlbWluaVNka0V2ZW50MltcIlNES19TSUdOX1RZUEVEX0RBVEFcIl0gPSBcIlNES19TSUdOX1RZUEVEX0RBVEFcIjtcbiAgR2VtaW5pU2RrRXZlbnQyW1wiU0RLX1NXSVRDSF9DSEFJTlwiXSA9IFwiU0RLX1NXSVRDSF9DSEFJTlwiO1xuICBHZW1pbmlTZGtFdmVudDJbXCJTREtfT1BFTl9TRVRUSU5HU1wiXSA9IFwiU0RLX09QRU5fU0VUVElOR1NcIjtcbiAgR2VtaW5pU2RrRXZlbnQyW1wiU0RLX0NVUlJFTlRfQUNDT1VOVFwiXSA9IFwiU0RLX0NVUlJFTlRfQUNDT1VOVFwiO1xuICByZXR1cm4gR2VtaW5pU2RrRXZlbnQyO1xufSkoR2VtaW5pU2RrRXZlbnQgfHwge30pO1xudmFyIFBsYXRmb3JtVHlwZSA9IHtcbiAgUkVBQ1RfTkFUSVZFOiBcIlJFQUNUX05BVElWRVwiLFxuICBXRUI6IFwiV0VCXCJcbn07XG52YXIgUHJvdmlkZXJFdmVudEVtaXR0ZXIgPSBjbGFzcyBleHRlbmRzIEV2ZW50RW1pdHRlciB7XG59O1xuXG4vLyBzcmMvdXRpbHMvYmFzZTY0LnRzXG5mdW5jdGlvbiBlbmNvZGVCYXNlNjQoYXJyYXkpIHtcbiAgbGV0IGJhc2U2NDtcbiAgaWYgKHR5cGVvZiBCdWZmZXIgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBiYXNlNjQgPSBCdWZmZXIuZnJvbShhcnJheSkudG9TdHJpbmcoXCJiYXNlNjRcIik7XG4gIH0gZWxzZSB7XG4gICAgYmFzZTY0ID0gYnRvYShcbiAgICAgIEFycmF5LmZyb20oYXJyYXkpLm1hcCgoYikgPT4gU3RyaW5nLmZyb21DaGFyQ29kZShiKSkuam9pbihcIlwiKVxuICAgICk7XG4gIH1cbiAgcmV0dXJuIGJhc2U2NC5yZXBsYWNlKC9cXCsvZywgXCItXCIpLnJlcGxhY2UoL1xcLy9nLCBcIl9cIikucmVwbGFjZSgvPSskLywgXCJcIik7XG59XG5mdW5jdGlvbiBkZWNvZGVCYXNlNjQoYmFzZTY0dXJsKSB7XG4gIGxldCBiYXNlNjQgPSBiYXNlNjR1cmwucmVwbGFjZSgvLS9nLCBcIitcIikucmVwbGFjZSgvXy9nLCBcIi9cIik7XG4gIHdoaWxlIChiYXNlNjQubGVuZ3RoICUgNCAhPT0gMCkge1xuICAgIGJhc2U2NCArPSBcIj1cIjtcbiAgfVxuICBpZiAodHlwZW9mIEJ1ZmZlciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHJldHVybiBuZXcgVWludDhBcnJheShCdWZmZXIuZnJvbShiYXNlNjQsIFwiYmFzZTY0XCIpKTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBiaW5hcnlTdHJpbmcgPSBhdG9iKGJhc2U2NCk7XG4gICAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShiaW5hcnlTdHJpbmcubGVuZ3RoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJpbmFyeVN0cmluZy5sZW5ndGg7IGkrKykge1xuICAgICAgYnl0ZXNbaV0gPSBiaW5hcnlTdHJpbmcuY2hhckNvZGVBdChpKTtcbiAgICB9XG4gICAgcmV0dXJuIGJ5dGVzO1xuICB9XG59XG5mdW5jdGlvbiBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyhidWZmZXIpIHtcbiAgY29uc3QgYnl0ZXMgPSBidWZmZXIgaW5zdGFuY2VvZiBVaW50OEFycmF5ID8gYnVmZmVyIDogbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKTtcbiAgcmV0dXJuIGVuY29kZUJhc2U2NChieXRlcyk7XG59XG5mdW5jdGlvbiB1dGY4U3RyaW5nVG9CdWZmZXIodmFsdWUpIHtcbiAgaWYgKHR5cGVvZiBUZXh0RW5jb2RlciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIHJldHVybiBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUodmFsdWUpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBCdWZmZXIgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoQnVmZmVyLmZyb20odmFsdWUsIFwidXRmOFwiKSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheSh2YWx1ZS5sZW5ndGgpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWUubGVuZ3RoOyBpKyspIHtcbiAgICAgIGJ5dGVzW2ldID0gdmFsdWUuY2hhckNvZGVBdChpKTtcbiAgICB9XG4gICAgcmV0dXJuIGJ5dGVzO1xuICB9XG59XG5mdW5jdGlvbiBiYXNlNjRUb0hleChiYXNlNjQpIHtcbiAgY29uc3QgYnl0ZXMgPSBkZWNvZGVCYXNlNjQoYmFzZTY0KTtcbiAgcmV0dXJuIEFycmF5LmZyb20oYnl0ZXMpLm1hcCgoYikgPT4gYi50b1N0cmluZygxNikucGFkU3RhcnQoMiwgXCIwXCIpKS5qb2luKFwiXCIpO1xufVxuXG4vLyBzcmMvdXRpbHMvY2FsY3VsYXRlV2FsbGV0QWRkcmVzcy50c1xuaW1wb3J0IHtcbiAgZW5jb2RlQWJpUGFyYW1ldGVycyxcbiAgZW5jb2RlRnVuY3Rpb25EYXRhLFxuICBlbmNvZGVQYWNrZWQsXG4gIGdldENyZWF0ZTJBZGRyZXNzLFxuICBrZWNjYWsyNTZcbn0gZnJvbSBcInZpZW1cIjtcbnZhciBTSEFSRURfQ09OVFJBQ1RfQUREUkVTU0VTID0ge1xuICBBVFRFU1RFUjogXCIweDAwMDQ3NDM5MmE5Y2Q4NmE0Njg3MzU0ZjFDZTI5NjRCNTJlOTc0ODRcIixcbiAgQk9PVFNUUkFQUEVSOiBcIjB4MDAwMDAwMDBEMzI1NDQ1MmE5MDlFNGVlRDQ3NDU1QWY3RTI3QzI4OVwiLFxuICBSRUdJU1RSWTogXCIweDAwMDAwMDAwMDA2OUUyYTE4N0FFRkZiODUyYkYzY0NkQzk1MTUxQjJcIlxufTtcbnZhciBWMl9DT05UUkFDVF9BRERSRVNTRVMgPSB7XG4gIC4uLlNIQVJFRF9DT05UUkFDVF9BRERSRVNTRVMsXG4gIEFDQ09VTlRfSU1QTEVNRU5UQVRJT046IFwiMHgwMDAwMDAwMDAyOWQ5YzhiODY0REQ1MWQ2YmIwZDk5RkI3MkQ2NTBiXCIsXG4gIEZBQ1RPUlk6IFwiMHgwMDAwMDAwMDA0NTIzNzdlMUJkOWU3MkU5Mzk4NTVFQ2I5MzYzQ2FiXCIsXG4gIFdFQkFVVEhOX1ZBTElEQVRPUjogXCIweDdhYjE2RmYzNTRBY0IzMjg0NTJGMUQ0NDViM0RkZWU5YTkxZTllNjlcIlxufTtcbnZhciBWMV9DT05UUkFDVF9BRERSRVNTRVMgPSB7XG4gIC4uLlNIQVJFRF9DT05UUkFDVF9BRERSRVNTRVMsXG4gIEFDQ09VTlRfSU1QTEVNRU5UQVRJT046IFwiMHgwMDA2MDUwMTY4REUyNTVhODY3MkFDYUQ0ODIxZTcyMUNCQTQ0MzM3XCIsXG4gIEZBQ1RPUlk6IFwiMHgwMEU1OERGNzBGYUI5ODNhMzI0YzRDMDY4YzgyZDIwNDA3NTc5RmFDXCIsXG4gIFdFQkFVVEhOX1ZBTElEQVRPUjogXCIweGJBNDVhMkJGYjhEZTNEMjRjQTlEN0YxQjU1MUUxNGRGRjVkNjkwRmRcIlxufTtcbmZ1bmN0aW9uIHByb2Nlc3NXYWxsZXRBZGRyZXNzUGFyYW1zKHBhcmFtcywgY29udHJhY3RBZGRyZXNzZXMpIHtcbiAgY29uc3QgeyBwdWJsaWNLZXksIGNyZWRlbnRpYWxJZCwgaW5kZXggPSAwbiB9ID0gcGFyYW1zO1xuICBpZiAoIXB1YmxpY0tleS5zdGFydHNXaXRoKFwiMHhcIikgfHwgcHVibGljS2V5Lmxlbmd0aCAhPT0gMTMwKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgXCJJbnZhbGlkIHB1YmxpYyBrZXk6IG11c3QgYmUgNjQtYnl0ZSBoZXggc3RyaW5nICgweCArIDEyOCBjaGFycylcIlxuICAgICk7XG4gIH1cbiAgY29uc3QgcHViS2V5WCA9IGAweCR7cHVibGljS2V5LnNsaWNlKDIsIDY2KX1gO1xuICBjb25zdCBwdWJLZXlZID0gYDB4JHtwdWJsaWNLZXkuc2xpY2UoNjYsIDEzMCl9YDtcbiAgY29uc3Qgd2ViQXV0aG5EYXRhID0ge1xuICAgIHB1YktleVg6IEJpZ0ludChwdWJLZXlYKSxcbiAgICBwdWJLZXlZOiBCaWdJbnQocHViS2V5WSlcbiAgfTtcbiAgaWYgKCF2YWxpZGF0ZVdlYkF1dGhuS2V5KHdlYkF1dGhuRGF0YSkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBcIkludmFsaWQgV2ViQXV0aG4ga2V5OiBjb29yZGluYXRlcyBhcmUgbm90IG9uIHNlY3AyNTZyMSBjdXJ2ZVwiXG4gICAgKTtcbiAgfVxuICBjb25zdCBhdXRoZW50aWNhdG9ySWRIYXNoID0gZ2VuZXJhdGVBdXRoZW50aWNhdG9ySWRIYXNoKGNyZWRlbnRpYWxJZCk7XG4gIHJldHVybiBjYWxjdWxhdGVBZGRyZXNzSW50ZXJuYWwoe1xuICAgIGF1dGhlbnRpY2F0b3JJZEhhc2gsXG4gICAgY29udHJhY3RBZGRyZXNzZXMsXG4gICAgaW5kZXgsXG4gICAgd2ViQXV0aG5EYXRhXG4gIH0pO1xufVxuZnVuY3Rpb24gY2FsY3VsYXRlV2FsbGV0QWRkcmVzcyhwYXJhbXMpIHtcbiAgcmV0dXJuIHByb2Nlc3NXYWxsZXRBZGRyZXNzUGFyYW1zKHBhcmFtcywgVjJfQ09OVFJBQ1RfQUREUkVTU0VTKTtcbn1cbmZ1bmN0aW9uIGNhbGN1bGF0ZVYxQWRkcmVzcyhwYXJhbXMpIHtcbiAgcmV0dXJuIHByb2Nlc3NXYWxsZXRBZGRyZXNzUGFyYW1zKHBhcmFtcywgVjFfQ09OVFJBQ1RfQUREUkVTU0VTKTtcbn1cbmZ1bmN0aW9uIGdlbmVyYXRlQXV0aGVudGljYXRvcklkSGFzaChjcmVkZW50aWFsSWQpIHtcbiAgY29uc3QgcGFkZGluZyA9IFwiPVwiLnJlcGVhdCgoNCAtIGNyZWRlbnRpYWxJZC5sZW5ndGggJSA0KSAlIDQpO1xuICBjb25zdCBiYXNlNjQgPSBjcmVkZW50aWFsSWQucmVwbGFjZSgvLS9nLCBcIitcIikucmVwbGFjZSgvXy9nLCBcIi9cIikgKyBwYWRkaW5nO1xuICBjb25zdCBiaW5hcnlTdHJpbmcgPSBhdG9iKGJhc2U2NCk7XG4gIGNvbnN0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYmluYXJ5U3RyaW5nLmxlbmd0aCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYmluYXJ5U3RyaW5nLmxlbmd0aDsgaSsrKSB7XG4gICAgYnl0ZXNbaV0gPSBiaW5hcnlTdHJpbmcuY2hhckNvZGVBdChpKTtcbiAgfVxuICByZXR1cm4ga2VjY2FrMjU2KGJ5dGVzKTtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlV2ViQXV0aG5LZXkod2ViQXV0aG5EYXRhKSB7XG4gIGNvbnN0IFNFQ1AyNTZSMV9QID0gMHhmZmZmZmZmZjAwMDAwMDAxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmbjtcbiAgY29uc3QgU0VDUDI1NlIxX0IgPSAweDVhYzYzNWQ4YWEzYTkzZTdiM2ViYmQ1NTc2OTg4NmJjNjUxZDA2YjBjYzUzYjBmNjNiY2UzYzNlMjdkMjYwNGJuO1xuICBjb25zdCB7IHB1YktleVgsIHB1YktleVkgfSA9IHdlYkF1dGhuRGF0YTtcbiAgaWYgKHB1YktleVggPT09IDBuIHx8IHB1YktleVkgPT09IDBuIHx8IHB1YktleVggPj0gU0VDUDI1NlIxX1AgfHwgcHViS2V5WSA+PSBTRUNQMjU2UjFfUCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBjb25zdCB5U3F1YXJlZCA9IHB1YktleVkgKiBwdWJLZXlZICUgU0VDUDI1NlIxX1A7XG4gIGNvbnN0IHhDdWJlZCA9IHB1YktleVggKiBwdWJLZXlYICogcHViS2V5WCAlIFNFQ1AyNTZSMV9QO1xuICBjb25zdCB0aHJlZVggPSAzbiAqIHB1YktleVggJSBTRUNQMjU2UjFfUDtcbiAgY29uc3QgcmlnaHRTaWRlID0gKHhDdWJlZCArIFNFQ1AyNTZSMV9QIC0gdGhyZWVYICsgU0VDUDI1NlIxX0IpICUgU0VDUDI1NlIxX1A7XG4gIHJldHVybiB5U3F1YXJlZCA9PT0gcmlnaHRTaWRlO1xufVxuZnVuY3Rpb24gY2FsY3VsYXRlQWRkcmVzc0ludGVybmFsKHBhcmFtcykge1xuICBjb25zdCB7IHdlYkF1dGhuRGF0YSwgYXV0aGVudGljYXRvcklkSGFzaCwgaW5kZXgsIGNvbnRyYWN0QWRkcmVzc2VzIH0gPSBwYXJhbXM7XG4gIGNvbnN0IGZhY3RvcnlBZGRyZXNzID0gY29udHJhY3RBZGRyZXNzZXMuRkFDVE9SWTtcbiAgY29uc3QgYWNjb3VudEltcGxlbWVudGF0aW9uID0gY29udHJhY3RBZGRyZXNzZXMuQUNDT1VOVF9JTVBMRU1FTlRBVElPTjtcbiAgY29uc3Qgd2ViQXV0aG5WYWxpZGF0b3IgPSBjb250cmFjdEFkZHJlc3Nlcy5XRUJBVVRITl9WQUxJREFUT1I7XG4gIGNvbnN0IGF0dGVzdGVyID0gY29udHJhY3RBZGRyZXNzZXMuQVRURVNURVI7XG4gIGNvbnN0IGJvb3RzdHJhcHBlciA9IGNvbnRyYWN0QWRkcmVzc2VzLkJPT1RTVFJBUFBFUjtcbiAgY29uc3QgcmVnaXN0cnkgPSBjb250cmFjdEFkZHJlc3Nlcy5SRUdJU1RSWTtcbiAgY29uc3Qgc2FsdCA9IGtlY2NhazI1NihcbiAgICBlbmNvZGVQYWNrZWQoXG4gICAgICBbXCJ1aW50MjU2XCIsIFwidWludDI1NlwiLCBcImJ5dGVzMzJcIiwgXCJ1aW50MjU2XCJdLFxuICAgICAgW3dlYkF1dGhuRGF0YS5wdWJLZXlYLCB3ZWJBdXRobkRhdGEucHViS2V5WSwgYXV0aGVudGljYXRvcklkSGFzaCwgaW5kZXhdXG4gICAgKVxuICApO1xuICBjb25zdCB2YWxpZGF0b3JJbml0RGF0YSA9IGVuY29kZUFiaVBhcmFtZXRlcnMoXG4gICAgW1xuICAgICAge1xuICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgeyBuYW1lOiBcInB1YktleVhcIiwgdHlwZTogXCJ1aW50MjU2XCIgfSxcbiAgICAgICAgICB7IG5hbWU6IFwicHViS2V5WVwiLCB0eXBlOiBcInVpbnQyNTZcIiB9XG4gICAgICAgIF0sXG4gICAgICAgIHR5cGU6IFwidHVwbGVcIlxuICAgICAgfSxcbiAgICAgIHsgdHlwZTogXCJieXRlczMyXCIgfVxuICAgIF0sXG4gICAgW3dlYkF1dGhuRGF0YSwgYXV0aGVudGljYXRvcklkSGFzaF1cbiAgKTtcbiAgY29uc3QgcmVnaXN0cnlDb25maWcgPSB7XG4gICAgYXR0ZXN0ZXJzOiBbYXR0ZXN0ZXJdLFxuICAgIHJlZ2lzdHJ5LFxuICAgIHRocmVzaG9sZDogMW5cbiAgfTtcbiAgY29uc3QgYm9vdHN0cmFwQ2FsbCA9IGVuY29kZUZ1bmN0aW9uRGF0YSh7XG4gICAgYWJpOiBbXG4gICAgICB7XG4gICAgICAgIGlucHV0czogW1xuICAgICAgICAgIHsgbmFtZTogXCJ2YWxpZGF0b3JcIiwgdHlwZTogXCJhZGRyZXNzXCIgfSxcbiAgICAgICAgICB7IG5hbWU6IFwidmFsaWRhdG9ySW5pdERhdGFcIiwgdHlwZTogXCJieXRlc1wiIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAgICB7IG5hbWU6IFwicmVnaXN0cnlcIiwgdHlwZTogXCJhZGRyZXNzXCIgfSxcbiAgICAgICAgICAgICAgeyBuYW1lOiBcImF0dGVzdGVyc1wiLCB0eXBlOiBcImFkZHJlc3NbXVwiIH0sXG4gICAgICAgICAgICAgIHsgbmFtZTogXCJ0aHJlc2hvbGRcIiwgdHlwZTogXCJ1aW50OFwiIH1cbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBuYW1lOiBcInJlZ2lzdHJ5Q29uZmlnXCIsXG4gICAgICAgICAgICB0eXBlOiBcInR1cGxlXCJcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIG5hbWU6IFwiaW5pdE5leHVzV2l0aFNpbmdsZVZhbGlkYXRvclwiLFxuICAgICAgICB0eXBlOiBcImZ1bmN0aW9uXCJcbiAgICAgIH1cbiAgICBdLFxuICAgIGFyZ3M6IFt3ZWJBdXRoblZhbGlkYXRvciwgdmFsaWRhdG9ySW5pdERhdGEsIHJlZ2lzdHJ5Q29uZmlnXSxcbiAgICBmdW5jdGlvbk5hbWU6IFwiaW5pdE5leHVzV2l0aFNpbmdsZVZhbGlkYXRvclwiXG4gIH0pO1xuICBjb25zdCBpbml0RGF0YSA9IGVuY29kZUFiaVBhcmFtZXRlcnMoXG4gICAgW3sgdHlwZTogXCJhZGRyZXNzXCIgfSwgeyB0eXBlOiBcImJ5dGVzXCIgfV0sXG4gICAgW2Jvb3RzdHJhcHBlciwgYm9vdHN0cmFwQ2FsbF1cbiAgKTtcbiAgcmV0dXJuIHByZWRpY3RQcm94eUFkZHJlc3MoXG4gICAgYWNjb3VudEltcGxlbWVudGF0aW9uLFxuICAgIHNhbHQsXG4gICAgaW5pdERhdGEsXG4gICAgZmFjdG9yeUFkZHJlc3NcbiAgKTtcbn1cbmZ1bmN0aW9uIHByZWRpY3RQcm94eUFkZHJlc3MoaW1wbGVtZW50YXRpb24sIHNhbHQsIGluaXREYXRhLCBkZXBsb3llcikge1xuICBjb25zdCBpbml0aWFsaXplQ2FsbCA9IGVuY29kZUZ1bmN0aW9uRGF0YSh7XG4gICAgYWJpOiBbXG4gICAgICB7XG4gICAgICAgIGlucHV0czogW3sgbmFtZTogXCJkYXRhXCIsIHR5cGU6IFwiYnl0ZXNcIiB9XSxcbiAgICAgICAgbmFtZTogXCJpbml0aWFsaXplQWNjb3VudFwiLFxuICAgICAgICB0eXBlOiBcImZ1bmN0aW9uXCJcbiAgICAgIH1cbiAgICBdLFxuICAgIGFyZ3M6IFtpbml0RGF0YV0sXG4gICAgZnVuY3Rpb25OYW1lOiBcImluaXRpYWxpemVBY2NvdW50XCJcbiAgfSk7XG4gIGNvbnN0IGNvbnN0cnVjdG9yQXJncyA9IGVuY29kZUFiaVBhcmFtZXRlcnMoXG4gICAgW3sgdHlwZTogXCJhZGRyZXNzXCIgfSwgeyB0eXBlOiBcImJ5dGVzXCIgfV0sXG4gICAgW2ltcGxlbWVudGF0aW9uLCBpbml0aWFsaXplQ2FsbF1cbiAgKTtcbiAgY29uc3QgbmV4dXNQcm94eUNyZWF0aW9uQ29kZSA9IFwiMHg2MDgwNjA0MDUyNjEwMmM4ODAzODAzODA2MTAwMTQ4MTYxMDE4YzU2NWI5MjgzMzk4MTAxNjA0MDgyODIwMzEyNjEwMTg4NTc4MTUxNjAwMTYwMDE2MGEwMWIwMzgxMTY5MjkwOTE5MDgzODMwMzYxMDE4ODU3NjAyMDgxMDE1MTkwNjAwMTYwMDE2MDQwMWIwMzgyMTE2MTAxODg1NzAxOTI4MTYwMWY4NTAxMTIxNTYxMDE4ODU3ODM1MTYxMDA2ZTYxMDA2OTgyNjEwMWM1NTY1YjYxMDE4YzU2NWI5NDgxODY1MjYwMjA4NjAxOTM2MDIwODM4MzAxMDExMTYxMDE4ODU3ODE1ZjkyNjAyMDgwOTMwMTg2NWU4NjAxMDE1MjYwMDE3ZjkwYjc3MmMyY2I4YTUxYWE3YThhNjVmYzIzNTQzYzZkMDIyZDViM2Y4ZTJiOTJlZWQ3OWZiYTdlZWY4MjkzMDA1ZDgyM2IxNTYxMDE3NjU3N2YzNjA4OTRhMTNiYTFhMzIxMDY2N2M4Mjg0OTJkYjk4ZGNhM2UyMDc2Y2MzNzM1YTkyMGEzY2E1MDVkMzgyYmJjODA1NDYwMDE2MDAxNjBhMDFiMDMxOTE2ODIxNzkwNTU3ZmJjN2NkNzVhMjBlZTI3ZmQ5YWRlYmFiMzIwNDFmNzU1MjE0ZGJjNmJmZmE5MGNjMDIyNWIzOWRhMmU1YzJkM2I1ZjgwYTI4MjUxMTU2MTAxNWU1NzVmODA5MTYxMDE0Njk0NTE5MDg0NWFmNDNkMTU2MTAxNTY1NzNkOTE2MTAxMzc2MTAwNjk4NDYxMDFjNTU2NWI5MjgzNTIzZDVmNjAyMDg1MDEzZTYxMDFlMDU2NWI1MDViNjA0MDUxNjA4OTkwODE2MTAyM2Y4MjM5ZjM1YjYwNjA5MTYxMDFlMDU2NWI1MDUwNTAzNDE1NjEwMTQ4NTc2M2IzOTg5NzlmNjBlMDFiNWY1MjYwMDQ1ZmZkNWI2MzRjOWM4Y2UzNjBlMDFiNWY1MjYwMDQ1MjYwMjQ1ZmZkNWI1ZjgwZmQ1YjYwNDA1MTkxOTA2MDFmMDE2MDFmMTkxNjgyMDE2MDAxNjAwMTYwNDAxYjAzODExMTgzODIxMDE3NjEwMWIxNTc2MDQwNTI1NjViNjM0ZTQ4N2I3MTYwZTAxYjVmNTI2MDQxNjAwNDUyNjAyNDVmZmQ1YjYwMDE2MDAxNjA0MDFiMDM4MTExNjEwMWIxNTc2MDFmMDE2MDFmMTkxNjYwMjAwMTkwNTY1YjkwNjEwMjA0NTc1MDgwNTExNTYxMDFmNTU3ODA1MTkwNjAyMDAxZmQ1YjYzZDZiZGEyNzU2MGUwMWI1ZjUyNjAwNDVmZmQ1YjgxNTExNTgwNjEwMjM1NTc1YjYxMDIxNTU3NTA5MDU2NWI2Mzk5OTZiMzE1NjBlMDFiNWY5MDgxNTI2MDAxNjAwMTYwYTAxYjAzOTE5MDkxMTY2MDA0NTI2MDI0OTBmZDViNTA4MDNiMTU2MTAyMGQ1NmZlNjA4MDYwNDA1MjM2MTU2MDUxNTc3ZjM2MDg5NGExM2JhMWEzMjEwNjY3YzgyODQ5MmRiOThkY2EzZTIwNzZjYzM3MzVhOTIwYTNjYTUwNWQzODJiYmM1NDVmOTA4MTkwNjAwMTYwMDE2MGEwMWIwMzE2MzY4MjgwMzc4MTM2OTE1YWY0M2Q1ZjgwM2UxNTYwNGQ1NzNkNWZmMzViM2Q1ZmZkNWIwMGZlYTI2NDY5NzA2NjczNTgyMjEyMjA0MWI1ZjcwYTM1MTk1MjE0MjIyM2YyMjUwNGNhN2I0ZTZkOTc1ZjNhMzAyZDExNGZmODIwNDQyZmNmODE1YWMyNjQ3MzZmNmM2MzQzMDAwODFiMDAzM1wiO1xuICBjb25zdCBpbml0Q29kZUhhc2ggPSBrZWNjYWsyNTYoXG4gICAgZW5jb2RlUGFja2VkKFtcImJ5dGVzXCIsIFwiYnl0ZXNcIl0sIFtuZXh1c1Byb3h5Q3JlYXRpb25Db2RlLCBjb25zdHJ1Y3RvckFyZ3NdKVxuICApO1xuICByZXR1cm4gZ2V0Q3JlYXRlMkFkZHJlc3Moe1xuICAgIGJ5dGVjb2RlSGFzaDogaW5pdENvZGVIYXNoLFxuICAgIGZyb206IGRlcGxveWVyLFxuICAgIHNhbHRcbiAgfSk7XG59XG5cbi8vIHNyYy91dGlscy9lbnMudHNcbmFzeW5jIGZ1bmN0aW9uIHJldmVyc2VSZXNvbHZlRW5zKGFkZHJlc3MpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke0VOU19BUElfVVJMfS9yZXZlcnNlLyR7YWRkcmVzc31gKTtcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBFTlMgQVBJIHJlcXVlc3QgZmFpbGVkOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWBcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFkZHJlc3M6IGRhdGEuYWRkcmVzcyxcbiAgICAgIG5hbWU6IGRhdGEubmFtZSB8fCBudWxsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHJlc29sdmUgRU5TIG5hbWU6XCIsIGVycm9yKTtcbiAgICByZXR1cm4ge1xuICAgICAgYWRkcmVzcyxcbiAgICAgIG5hbWU6IG51bGxcbiAgICB9O1xuICB9XG59XG5cbi8vIHNyYy91dGlscy9wb3B1cC50c1xuaW1wb3J0IHsgcnBjRXJyb3JzIH0gZnJvbSBcIkBtZXRhbWFzay9ycGMtZXJyb3JzXCI7XG52YXIgUE9QVVBfV0lEVEgyID0gNDIwO1xudmFyIFBPUFVQX0hFSUdIVDIgPSA2NTA7XG52YXIgb3BlblBvcHVwID0gKHVybCkgPT4ge1xuICBjb25zdCBsZWZ0ID0gKHdpbmRvdy5pbm5lcldpZHRoIC0gUE9QVVBfV0lEVEgyKSAvIDIgKyB3aW5kb3cuc2NyZWVuWDtcbiAgY29uc3QgdG9wID0gKHdpbmRvdy5pbm5lckhlaWdodCAtIFBPUFVQX0hFSUdIVDIpIC8gMiArIHdpbmRvdy5zY3JlZW5ZO1xuICBjb25zdCBwb3B1cElkID0gYHdhbGxldF8ke3dpbmRvdz8uY3J5cHRvPy5yYW5kb21VVUlEKCl9YDtcbiAgY29uc3QgcG9wdXAgPSB3aW5kb3cub3BlbihcbiAgICB1cmwsXG4gICAgcG9wdXBJZCxcbiAgICBgd2lkdGg9JHtQT1BVUF9XSURUSDJ9LCBoZWlnaHQ9JHtQT1BVUF9IRUlHSFQyfSwgbGVmdD0ke2xlZnR9LCB0b3A9JHt0b3B9YFxuICApO1xuICBwb3B1cD8uZm9jdXMoKTtcbiAgaWYgKCFwb3B1cCkge1xuICAgIHRocm93IHJwY0Vycm9ycy5pbnRlcm5hbChcIlBvcCB1cCB3aW5kb3cgZmFpbGVkIHRvIG9wZW5cIik7XG4gIH1cbiAgcmV0dXJuIHBvcHVwO1xufTtcbnZhciBjbG9zZVBvcHVwID0gKHBvcHVwKSA9PiB7XG4gIGlmIChwb3B1cCAmJiAhcG9wdXAuY2xvc2VkKSB7XG4gICAgcG9wdXAub3BlbmVyPy5mb2N1cygpO1xuICAgIHBvcHVwLmNsb3NlKCk7XG4gIH1cbn07XG5cbi8vIHNyYy91dGlscy9zdHJpbmdzLnRzXG52YXIgaGV4U3RyaW5nRnJvbU51bWJlciA9IChudW0pID0+IHtcbiAgcmV0dXJuIGAweCR7QmlnSW50KG51bSkudG9TdHJpbmcoMTYpfWA7XG59O1xudmFyIHNhZmVKc29uU3RyaW5naWZ5ID0gKG9iaikgPT4gSlNPTi5zdHJpbmdpZnkoXG4gIG9iaixcbiAgKF8sIHZhbHVlKSA9PiB0eXBlb2YgdmFsdWUgPT09IFwiYmlnaW50XCIgPyB2YWx1ZS50b1N0cmluZygpICsgXCJuXCIgOiB2YWx1ZSxcbiAgMlxuKTtcblxuLy8gc3JjL2NvbW11bmljYXRvci50c1xudmFyIENvbW11bmljYXRvciA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3IoeyBhcHBNZXRhZGF0YSwgb25EaXNjb25uZWN0Q2FsbGJhY2sgfSkge1xuICAgIHRoaXMucG9wdXAgPSBudWxsO1xuICAgIHRoaXMubGlzdGVuZXJzID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICAvLyBwb3N0cyBhIG1lc3NhZ2UgdG8gdGhlIHBvcHVwIHdpbmRvd1xuICAgIHRoaXMucG9zdE1lc3NhZ2UgPSBhc3luYyAobWVzc2FnZSkgPT4ge1xuICAgICAgY29uc3QgcG9wdXAgPSBhd2FpdCB0aGlzLndhaXRGb3JQb3B1cExvYWRlZCgpO1xuICAgICAgcG9wdXAucG9zdE1lc3NhZ2UobWVzc2FnZSwgdGhpcy51cmwub3JpZ2luKTtcbiAgICB9O1xuICAgIC8vIHBvc3RzIGEgcmVxdWVzdCB0byB0aGUgcG9wdXAgd2luZG93IGFuZCB3YWl0cyBmb3IgYSByZXNwb25zZVxuICAgIHRoaXMucG9zdFJlcXVlc3RBbmRXYWl0Rm9yUmVzcG9uc2UgPSBhc3luYyAocmVxdWVzdCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2VQcm9taXNlID0gdGhpcy5vbk1lc3NhZ2UoXG4gICAgICAgICh7IHJlcXVlc3RJZCB9KSA9PiByZXF1ZXN0SWQgPT09IHJlcXVlc3QucmVxdWVzdElkXG4gICAgICApO1xuICAgICAgdGhpcy5wb3N0TWVzc2FnZShyZXF1ZXN0KTtcbiAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZVByb21pc2U7XG4gICAgfTtcbiAgICAvLyBsaXN0ZW5zIGZvciBtZXNzYWdlcyBmcm9tIHRoZSBwb3B1cCB3aW5kb3cgdGhhdCBtYXRjaCBhIGdpdmVuIHByZWRpY2F0ZVxuICAgIHRoaXMub25NZXNzYWdlID0gKHByZWRpY2F0ZSkgPT4ge1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgbGlzdGVuZXIgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICBpZiAoZXZlbnQub3JpZ2luICE9PSB0aGlzLnVybC5vcmlnaW4pIHJldHVybjtcbiAgICAgICAgICBjb25zdCBtZXNzYWdlID0gZXZlbnQuZGF0YTtcbiAgICAgICAgICBpZiAocHJlZGljYXRlKG1lc3NhZ2UpKSB7XG4gICAgICAgICAgICByZXNvbHZlKG1lc3NhZ2UpO1xuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGxpc3RlbmVyKTtcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzLmRlbGV0ZShsaXN0ZW5lcik7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgbGlzdGVuZXIpO1xuICAgICAgICB0aGlzLmxpc3RlbmVycy5zZXQobGlzdGVuZXIsIHsgcmVqZWN0IH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICAvLyBjbG9zZXMgdGhlIHBvcHVwLCByZWplY3RzIGFsbCByZXF1ZXN0cyBhbmQgY2xlYXJzIGV2ZW50IGxpc3RlbmVyc1xuICAgIHRoaXMub25SZXF1ZXN0Q2FuY2VsbGVkID0gKCkgPT4ge1xuICAgICAgY2xvc2VQb3B1cCh0aGlzLnBvcHVwKTtcbiAgICAgIHRoaXMucG9wdXAgPSBudWxsO1xuICAgICAgdGhpcy5saXN0ZW5lcnMuZm9yRWFjaCgoeyByZWplY3QgfSwgbGlzdGVuZXIpID0+IHtcbiAgICAgICAgcmVqZWN0KHByb3ZpZGVyRXJyb3JzLnVzZXJSZWplY3RlZFJlcXVlc3QoKSk7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBsaXN0ZW5lcik7XG4gICAgICB9KTtcbiAgICAgIHRoaXMubGlzdGVuZXJzLmNsZWFyKCk7XG4gICAgfTtcbiAgICAvLyB3YWl0cyBmb3IgdGhlIHBvcHVwIHdpbmRvdyB0byBmdWxseSBsb2FkIGFuZCB0aGVuIHNlbmRzIGEgdmVyc2lvbiBtZXNzYWdlXG4gICAgdGhpcy53YWl0Rm9yUG9wdXBMb2FkZWQgPSAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5wb3B1cCAmJiAhdGhpcy5wb3B1cC5jbG9zZWQpIHtcbiAgICAgICAgdGhpcy5wb3B1cC5mb2N1cygpO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMucG9wdXApO1xuICAgICAgfVxuICAgICAgdGhpcy5wb3B1cCA9IG9wZW5Qb3B1cCh0aGlzLnVybCk7XG4gICAgICB0aGlzLm9uTWVzc2FnZShcbiAgICAgICAgKHsgZXZlbnQgfSkgPT4gZXZlbnQgPT09IFwiUE9QVVBfVU5MT0FERURcIiAvKiBQT1BVUF9VTkxPQURFRCAqL1xuICAgICAgKS50aGVuKHRoaXMub25SZXF1ZXN0Q2FuY2VsbGVkKS5jYXRjaCgoKSA9PiB7XG4gICAgICB9KTtcbiAgICAgIHRoaXMub25NZXNzYWdlKFxuICAgICAgICAoeyBldmVudCB9KSA9PiBldmVudCA9PT0gXCJTREtfRElTQ09OTkVDVFwiIC8qIFNES19ESVNDT05ORUNUICovXG4gICAgICApLnRoZW4oKCkgPT4ge1xuICAgICAgICB0aGlzLm9uRGlzY29ubmVjdENhbGxiYWNrPy4oKTtcbiAgICAgICAgdGhpcy5vblJlcXVlc3RDYW5jZWxsZWQoKTtcbiAgICAgIH0pLmNhdGNoKCgpID0+IHtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRoaXMub25NZXNzYWdlKFxuICAgICAgICAoeyBldmVudCB9KSA9PiBldmVudCA9PT0gXCJQT1BVUF9MT0FERURcIiAvKiBQT1BVUF9MT0FERUQgKi9cbiAgICAgICkudGhlbigobWVzc2FnZSkgPT4ge1xuICAgICAgICB0aGlzLnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICBjaGFpbklkOiBERUZBVUxUX0NIQUlOX0lELFxuICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgIGFwcE1ldGFkYXRhOiB0aGlzLmFwcE1ldGFkYXRhLFxuICAgICAgICAgICAgb3JpZ2luOiB3aW5kb3cubG9jYXRpb24ub3JpZ2luLFxuICAgICAgICAgICAgc2RrVmVyc2lvbjogU0RLX1ZFUlNJT05cbiAgICAgICAgICB9LFxuICAgICAgICAgIGV2ZW50OiBcIlBPUFVQX0FQUF9DT05URVhUXCIgLyogUE9QVVBfQVBQX0NPTlRFWFQgKi8sXG4gICAgICAgICAgb3JpZ2luOiB3aW5kb3cubG9jYXRpb24ub3JpZ2luLFxuICAgICAgICAgIHJlcXVlc3RJZDogbWVzc2FnZS5yZXF1ZXN0SWRcbiAgICAgICAgfSk7XG4gICAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLnBvcHVwKSB0aHJvdyBycGNFcnJvcnMyLmludGVybmFsKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnBvcHVwO1xuICAgICAgfSk7XG4gICAgfTtcbiAgICB0aGlzLnVybCA9IG5ldyBVUkwoU0RLX0JBQ0tFTkRfVVJMKTtcbiAgICB0aGlzLmFwcE1ldGFkYXRhID0gYXBwTWV0YWRhdGE7XG4gICAgdGhpcy5vbkRpc2Nvbm5lY3RDYWxsYmFjayA9IG9uRGlzY29ubmVjdENhbGxiYWNrO1xuICB9XG59O1xuXG4vLyBzcmMvcHJvdmlkZXIvcHJvdmlkZXIudHNcbmltcG9ydCB7XG4gIGVycm9yQ29kZXMsXG4gIHByb3ZpZGVyRXJyb3JzIGFzIHByb3ZpZGVyRXJyb3JzMixcbiAgcnBjRXJyb3JzIGFzIHJwY0Vycm9yczQsXG4gIHNlcmlhbGl6ZUVycm9yXG59IGZyb20gXCJAbWV0YW1hc2svcnBjLWVycm9yc1wiO1xuXG4vLyBzcmMvc3RvcmFnZS9zdG9yYWdlLnRzXG52YXIgbWVtb3J5U3RvcmFnZSA9IHt9O1xudmFyIEdlbWluaVN0b3JhZ2UgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKHtcbiAgICBzY29wZSA9IFwiQGdlbWluaVwiLFxuICAgIG1vZHVsZSA9IFwid2FsbGV0XCJcbiAgfSA9IHt9KSB7XG4gICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgIHRoaXMubW9kdWxlID0gbW9kdWxlO1xuICB9XG4gIHNjb3BlZEtleShrZXkpIHtcbiAgICByZXR1cm4gYCR7dGhpcy5zY29wZX0uJHt0aGlzLm1vZHVsZX0uJHtrZXl9YDtcbiAgfVxuICBhc3luYyBzdG9yZU9iamVjdChrZXksIGl0ZW0pIHtcbiAgICBjb25zdCBqc29uID0gc2FmZUpzb25TdHJpbmdpZnkoaXRlbSk7XG4gICAgYXdhaXQgdGhpcy5zZXRJdGVtKGtleSwganNvbik7XG4gIH1cbiAgYXN5bmMgbG9hZE9iamVjdChrZXksIGZhbGxiYWNrKSB7XG4gICAgY29uc3QgaXRlbSA9IGF3YWl0IHRoaXMuZ2V0SXRlbShrZXkpO1xuICAgIGlmICghaXRlbSkge1xuICAgICAgYXdhaXQgdGhpcy5zdG9yZU9iamVjdChrZXksIGZhbGxiYWNrKTtcbiAgICAgIHJldHVybiBmYWxsYmFjaztcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKGl0ZW0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBwYXJzaW5nIEpTT04gZm9yIGtleSAke2tleX06YCwgZXJyb3IpO1xuICAgICAgcmV0dXJuIGZhbGxiYWNrO1xuICAgIH1cbiAgfVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVxdWlyZS1hd2FpdFxuICBhc3luYyBzZXRJdGVtKGtleSwgdmFsdWUpIHtcbiAgICBjb25zdCBzY29wZWQgPSB0aGlzLnNjb3BlZEtleShrZXkpO1xuICAgIHRyeSB7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShzY29wZWQsIHZhbHVlKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJsb2NhbFN0b3JhZ2Ugbm90IGF2YWlsYWJsZSwgdXNpbmcgbWVtb3J5IHN0b3JhZ2VcIiwgZSk7XG4gICAgICBtZW1vcnlTdG9yYWdlW3Njb3BlZF0gPSB2YWx1ZTtcbiAgICB9XG4gIH1cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlcXVpcmUtYXdhaXRcbiAgYXN5bmMgZ2V0SXRlbShrZXkpIHtcbiAgICBjb25zdCBzY29wZWQgPSB0aGlzLnNjb3BlZEtleShrZXkpO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0oc2NvcGVkKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJsb2NhbFN0b3JhZ2Ugbm90IGF2YWlsYWJsZSwgdXNpbmcgbWVtb3J5IHN0b3JhZ2VcIiwgZSk7XG4gICAgICByZXR1cm4gbWVtb3J5U3RvcmFnZVtzY29wZWRdIHx8IG51bGw7XG4gICAgfVxuICB9XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZXF1aXJlLWF3YWl0XG4gIGFzeW5jIHJlbW92ZUl0ZW0oa2V5KSB7XG4gICAgY29uc3Qgc2NvcGVkID0gdGhpcy5zY29wZWRLZXkoa2V5KTtcbiAgICB0cnkge1xuICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oc2NvcGVkKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJsb2NhbFN0b3JhZ2Ugbm90IGF2YWlsYWJsZSwgdXNpbmcgbWVtb3J5IHN0b3JhZ2VcIiwgZSk7XG4gICAgICBkZWxldGUgbWVtb3J5U3RvcmFnZVtzY29wZWRdO1xuICAgIH1cbiAgfVxuICBhc3luYyByZW1vdmVJdGVtcyhrZXlzKSB7XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoa2V5cy5tYXAoKGtleSkgPT4gdGhpcy5yZW1vdmVJdGVtKGtleSkpKTtcbiAgfVxufTtcblxuLy8gc3JjL3N0b3JhZ2Uvc3RvcmFnZUludGVyZmFjZS50c1xudmFyIFNUT1JBR0VfRVRIX0FDQ09VTlRTX0tFWSA9IFwiZXRoLWFjY291bnRzXCI7XG52YXIgU1RPUkFHRV9FVEhfQUNUSVZFX0NIQUlOX0tFWSA9IFwiZXRoLWFjdGl2ZS1jaGFpblwiO1xudmFyIFNUT1JBR0VfUEFTU0tFWV9DUkVERU5USUFMX0tFWSA9IFwicGFzc2tleS1jcmVkZW50aWFsXCI7XG52YXIgU1RPUkFHRV9QUkVTRVJWRURfUEFTU0tFWV9DUkVERU5USUFMU19LRVkgPSBcInByZXNlcnZlZC1wYXNza2V5LWNyZWRlbnRpYWxzXCI7XG52YXIgU1RPUkFHRV9TTUFSVF9BQ0NPVU5UX0tFWSA9IFwic21hcnQtYWNjb3VudFwiO1xudmFyIFNUT1JBR0VfU0VUVElOR1NfS0VZID0gXCJzZXR0aW5nc1wiO1xudmFyIFNUT1JBR0VfV0NfUkVRVUVTVFNfS0VZID0gXCJ3Yy1yZXF1ZXN0c1wiO1xuXG4vLyBzcmMvd2FsbGV0cy93YWxsZXQudHNcbmZ1bmN0aW9uIGlzQ2hhaW5TdXBwb3J0ZWRCeUdlbWluaVN3KGNoYWluSWQpIHtcbiAgcmV0dXJuIFNVUFBPUlRFRF9DSEFJTl9JRFMuaW5jbHVkZXMoXG4gICAgY2hhaW5JZFxuICApO1xufVxudmFyIEdlbWluaVdhbGxldCA9IGNsYXNzIHtcbiAgY29uc3RydWN0b3Ioe1xuICAgIGFwcE1ldGFkYXRhLFxuICAgIGNoYWluLFxuICAgIG9uRGlzY29ubmVjdENhbGxiYWNrLFxuICAgIHN0b3JhZ2VcbiAgfSkge1xuICAgIHRoaXMuYWNjb3VudHMgPSBbXTtcbiAgICB0aGlzLmNoYWluID0geyBpZDogREVGQVVMVF9DSEFJTl9JRCB9O1xuICAgIHRoaXMuY29tbXVuaWNhdG9yID0gbmV3IENvbW11bmljYXRvcih7XG4gICAgICBhcHBNZXRhZGF0YSxcbiAgICAgIG9uRGlzY29ubmVjdENhbGxiYWNrXG4gICAgfSk7XG4gICAgdGhpcy5zdG9yYWdlID0gc3RvcmFnZSB8fCBuZXcgR2VtaW5pU3RvcmFnZSgpO1xuICAgIGNvbnN0IGZhbGxiYWNrQ2hhaW5JZCA9IGNoYWluPy5pZCA/PyBERUZBVUxUX0NIQUlOX0lEO1xuICAgIGNvbnN0IGZhbGxiYWNrUnBjVXJsID0gY2hhaW4/LnJwY1VybCA/PyBnZXREZWZhdWx0UnBjVXJsKGZhbGxiYWNrQ2hhaW5JZCk7XG4gICAgY29uc3QgZGVmYXVsdENoYWluID0ge1xuICAgICAgaWQ6IGZhbGxiYWNrQ2hhaW5JZCxcbiAgICAgIHJwY1VybDogZmFsbGJhY2tScGNVcmxcbiAgICB9O1xuICAgIHRoaXMuaW5pdFByb21pc2UgPSB0aGlzLmluaXRpYWxpemVGcm9tU3RvcmFnZShkZWZhdWx0Q2hhaW4pO1xuICB9XG4gIGFzeW5jIGluaXRpYWxpemVGcm9tU3RvcmFnZShkZWZhdWx0Q2hhaW4pIHtcbiAgICBjb25zdCBmYWxsYmFja0NoYWluID0ge1xuICAgICAgLi4uZGVmYXVsdENoYWluLFxuICAgICAgcnBjVXJsOiBkZWZhdWx0Q2hhaW4ucnBjVXJsIHx8IGdldERlZmF1bHRScGNVcmwoZGVmYXVsdENoYWluLmlkKVxuICAgIH07XG4gICAgY29uc3QgW3N0b3JlZENoYWluLCBzdG9yZWRBY2NvdW50c10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICB0aGlzLnN0b3JhZ2UubG9hZE9iamVjdChcbiAgICAgICAgU1RPUkFHRV9FVEhfQUNUSVZFX0NIQUlOX0tFWSxcbiAgICAgICAgZmFsbGJhY2tDaGFpblxuICAgICAgKSxcbiAgICAgIHRoaXMuc3RvcmFnZS5sb2FkT2JqZWN0KFxuICAgICAgICBTVE9SQUdFX0VUSF9BQ0NPVU5UU19LRVksXG4gICAgICAgIHRoaXMuYWNjb3VudHNcbiAgICAgIClcbiAgICBdKTtcbiAgICB0aGlzLmNoYWluID0ge1xuICAgICAgLi4uc3RvcmVkQ2hhaW4sXG4gICAgICBycGNVcmw6IHN0b3JlZENoYWluLnJwY1VybCB8fCBnZXREZWZhdWx0UnBjVXJsKHN0b3JlZENoYWluLmlkKVxuICAgIH07XG4gICAgdGhpcy5hY2NvdW50cyA9IHN0b3JlZEFjY291bnRzO1xuICB9XG4gIGFzeW5jIGVuc3VyZUluaXRpYWxpemVkKCkge1xuICAgIGF3YWl0IHRoaXMuaW5pdFByb21pc2U7XG4gIH1cbiAgYXN5bmMgY29ubmVjdCgpIHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnNlbmRNZXNzYWdlVG9Qb3B1cCh7XG4gICAgICBjaGFpbklkOiB0aGlzLmNoYWluLmlkLFxuICAgICAgZXZlbnQ6IFwiU0RLX0NPTk5FQ1RcIiAvKiBTREtfQ09OTkVDVCAqLyxcbiAgICAgIG9yaWdpbjogd2luZG93LmxvY2F0aW9uLm9yaWdpblxuICAgIH0pO1xuICAgIHRoaXMuYWNjb3VudHMgPSByZXNwb25zZS5kYXRhLmFkZHJlc3MgPyBbcmVzcG9uc2UuZGF0YS5hZGRyZXNzXSA6IFtdO1xuICAgIGF3YWl0IHRoaXMuc3RvcmFnZS5zdG9yZU9iamVjdChTVE9SQUdFX0VUSF9BQ0NPVU5UU19LRVksIHRoaXMuYWNjb3VudHMpO1xuICAgIHJldHVybiB0aGlzLmFjY291bnRzO1xuICB9XG4gIGFzeW5jIGRpc2Nvbm5lY3QoKSB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIHRoaXMuYWNjb3VudHMgPSBbXTtcbiAgICBhd2FpdCB0aGlzLnN0b3JhZ2Uuc3RvcmVPYmplY3QoU1RPUkFHRV9FVEhfQUNDT1VOVFNfS0VZLCB0aGlzLmFjY291bnRzKTtcbiAgfVxuICBhc3luYyBzd2l0Y2hDaGFpbih7IGlkIH0pIHtcbiAgICBhd2FpdCB0aGlzLmVuc3VyZUluaXRpYWxpemVkKCk7XG4gICAgaWYgKGlzQ2hhaW5TdXBwb3J0ZWRCeUdlbWluaVN3KGlkKSkge1xuICAgICAgdGhpcy5jaGFpbiA9IHtcbiAgICAgICAgaWQsXG4gICAgICAgIHJwY1VybDogZ2V0RGVmYXVsdFJwY1VybChpZClcbiAgICAgIH07XG4gICAgICBhd2FpdCB0aGlzLnN0b3JhZ2Uuc3RvcmVPYmplY3QoU1RPUkFHRV9FVEhfQUNUSVZFX0NIQUlOX0tFWSwgdGhpcy5jaGFpbik7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnNlbmRNZXNzYWdlVG9Qb3B1cCh7XG4gICAgICBjaGFpbklkOiB0aGlzLmNoYWluLmlkLFxuICAgICAgZGF0YTogaWQsXG4gICAgICBldmVudDogXCJTREtfU1dJVENIX0NIQUlOXCIgLyogU0RLX1NXSVRDSF9DSEFJTiAqLyxcbiAgICAgIG9yaWdpbjogd2luZG93LmxvY2F0aW9uLm9yaWdpblxuICAgIH0pO1xuICAgIHJldHVybiByZXNwb25zZS5kYXRhLmVycm9yID8/IFwiVW5zdXBwb3J0ZWQgY2hhaW4uXCI7XG4gIH1cbiAgYXN5bmMgc2VuZFRyYW5zYWN0aW9uKHR4RGF0YSkge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuc2VuZE1lc3NhZ2VUb1BvcHVwKHtcbiAgICAgIGNoYWluSWQ6IHRoaXMuY2hhaW4uaWQsXG4gICAgICBkYXRhOiB0eERhdGEsXG4gICAgICBldmVudDogXCJTREtfU0VORF9UUkFOU0FDVElPTlwiIC8qIFNES19TRU5EX1RSQU5TQUNUSU9OICovLFxuICAgICAgb3JpZ2luOiB3aW5kb3cubG9jYXRpb24ub3JpZ2luXG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gIH1cbiAgYXN5bmMgc2lnbkRhdGEoe1xuICAgIG1lc3NhZ2VcbiAgfSkge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuc2VuZE1lc3NhZ2VUb1BvcHVwKHtcbiAgICAgIGNoYWluSWQ6IHRoaXMuY2hhaW4uaWQsXG4gICAgICBkYXRhOiB7IG1lc3NhZ2UgfSxcbiAgICAgIGV2ZW50OiBcIlNES19TSUdOX0RBVEFcIiAvKiBTREtfU0lHTl9EQVRBICovLFxuICAgICAgb3JpZ2luOiB3aW5kb3cubG9jYXRpb24ub3JpZ2luXG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XG4gIH1cbiAgYXN5bmMgc2lnblR5cGVkRGF0YSh7XG4gICAgbWVzc2FnZSxcbiAgICB0eXBlcyxcbiAgICBwcmltYXJ5VHlwZSxcbiAgICBkb21haW5cbiAgfSkge1xuICAgIGF3YWl0IHRoaXMuZW5zdXJlSW5pdGlhbGl6ZWQoKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuc2VuZE1lc3NhZ2VUb1BvcHVwKHtcbiAgICAgIGNoYWluSWQ6IHRoaXMuY2hhaW4uaWQsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIGRvbWFpbixcbiAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgcHJpbWFyeVR5cGUsXG4gICAgICAgIHR5cGVzXG4gICAgICB9LFxuICAgICAgZXZlbnQ6IFwiU0RLX1NJR05fVFlQRURfREFUQVwiIC8qIFNES19TSUdOX1RZUEVEX0RBVEEgKi8sXG4gICAgICBvcmlnaW46IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW5cbiAgICB9KTtcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgfVxuICBhc3luYyBvcGVuU2V0dGluZ3MoKSB7XG4gICAgYXdhaXQgdGhpcy5lbnN1cmVJbml0aWFsaXplZCgpO1xuICAgIGF3YWl0IHRoaXMuc2VuZE1lc3NhZ2VUb1BvcHVwKHtcbiAgICAgIGNoYWluSWQ6IHRoaXMuY2hhaW4uaWQsXG4gICAgICBkYXRhOiB7fSxcbiAgICAgIGV2ZW50OiBcIlNES19PUEVOX1NFVFRJTkdTXCIgLyogU0RLX09QRU5fU0VUVElOR1MgKi8sXG4gICAgICBvcmlnaW46IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW5cbiAgICB9KTtcbiAgfVxuICBzZW5kTWVzc2FnZVRvUG9wdXAocmVxdWVzdCkge1xuICAgIHJldHVybiB0aGlzLmNvbW11bmljYXRvci5wb3N0UmVxdWVzdEFuZFdhaXRGb3JSZXNwb25zZSh7XG4gICAgICAuLi5yZXF1ZXN0LFxuICAgICAgcmVxdWVzdElkOiB3aW5kb3c/LmNyeXB0bz8ucmFuZG9tVVVJRCgpXG4gICAgfSk7XG4gIH1cbn07XG5cbi8vIHNyYy9wcm92aWRlci9wcm92aWRlci51dGlscy50c1xuaW1wb3J0IHsgcnBjRXJyb3JzIGFzIHJwY0Vycm9yczMgfSBmcm9tIFwiQG1ldGFtYXNrL3JwYy1lcnJvcnNcIjtcbmltcG9ydCB7IGlzSGV4IH0gZnJvbSBcInZpZW1cIjtcbnZhciBmZXRjaFJwY1JlcXVlc3QgPSBhc3luYyAocmVxdWVzdCwgcnBjVXJsKSA9PiB7XG4gIGNvbnN0IHJlcXVlc3RCb2R5ID0ge1xuICAgIC4uLnJlcXVlc3QsXG4gICAgaWQ6IHdpbmRvdz8uY3J5cHRvPy5yYW5kb21VVUlEKCksXG4gICAganNvbnJwYzogXCIyLjBcIlxuICB9O1xuICBjb25zdCByZXMgPSBhd2FpdCB3aW5kb3cuZmV0Y2gocnBjVXJsLCB7XG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmVxdWVzdEJvZHkpLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgfSxcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIG1vZGU6IFwiY29yc1wiXG4gIH0pO1xuICBjb25zdCB7IHJlc3VsdCwgZXJyb3IgfSA9IGF3YWl0IHJlcy5qc29uKCk7XG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuZnVuY3Rpb24gdmFsaWRhdGVScGNSZXF1ZXN0QXJncyhhcmdzKSB7XG4gIGlmICghYXJncyB8fCB0eXBlb2YgYXJncyAhPT0gXCJvYmplY3RcIiB8fCBBcnJheS5pc0FycmF5KGFyZ3MpKSB7XG4gICAgdGhyb3cgcnBjRXJyb3JzMy5pbnZhbGlkUGFyYW1zKHtcbiAgICAgIG1lc3NhZ2U6IFwiRXhwZWN0ZWQgYSBzaW5nbGUsIG5vbi1hcnJheSwgb2JqZWN0IGFyZ3VtZW50LlwiXG4gICAgfSk7XG4gIH1cbiAgY29uc3QgeyBtZXRob2QsIHBhcmFtcyB9ID0gYXJncztcbiAgaWYgKHR5cGVvZiBtZXRob2QgIT09IFwic3RyaW5nXCIgfHwgbWV0aG9kLmxlbmd0aCA9PT0gMCkge1xuICAgIHRocm93IHJwY0Vycm9yczMuaW52YWxpZFBhcmFtcyh7XG4gICAgICBtZXNzYWdlOiBcIidhcmdzLm1ldGhvZCcgbXVzdCBiZSBhIG5vbi1lbXB0eSBzdHJpbmcuXCJcbiAgICB9KTtcbiAgfVxuICBpZiAocGFyYW1zICE9PSB2b2lkIDAgJiYgIUFycmF5LmlzQXJyYXkocGFyYW1zKSAmJiAodHlwZW9mIHBhcmFtcyAhPT0gXCJvYmplY3RcIiB8fCBwYXJhbXMgPT09IG51bGwpKSB7XG4gICAgdGhyb3cgcnBjRXJyb3JzMy5pbnZhbGlkUGFyYW1zKHtcbiAgICAgIG1lc3NhZ2U6IFwiJ2FyZ3MucGFyYW1zJyBtdXN0IGJlIGFuIG9iamVjdCBvciBhcnJheSBpZiBwcm92aWRlZC5cIlxuICAgIH0pO1xuICB9XG59XG5mdW5jdGlvbiBjb252ZXJ0U2VuZFZhbHVlc1RvQmlnSW50KHR4KSB7XG4gIGNvbnN0IEZJRUxEU19UT19OT1JNQUxJWkUgPSBbXCJ2YWx1ZVwiLCBcImdhc1wiLCBcImdhc1ByaWNlXCIsIFwibWF4UHJpb3JpdHlGZWVQZXJHYXNcIiwgXCJtYXhGZWVQZXJHYXNcIl07XG4gIGNvbnN0IG5vcm1hbGl6ZWQgPSB7IC4uLnR4IH07XG4gIGZvciAoY29uc3QgZmllbGQgb2YgRklFTERTX1RPX05PUk1BTElaRSkge1xuICAgIGlmICghKGZpZWxkIGluIHR4KSkgY29udGludWU7XG4gICAgY29uc3QgdmFsdWUgPSB0eFtmaWVsZF07XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJiaWdpbnRcIikgY29udGludWU7XG4gICAgaWYgKGlzSGV4KHZhbHVlKSkge1xuICAgICAgbm9ybWFsaXplZFtmaWVsZF0gPSBCaWdJbnQodmFsdWUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbm9ybWFsaXplZDtcbn1cblxuLy8gc3JjL3Byb3ZpZGVyL3Byb3ZpZGVyLnRzXG52YXIgR2VtaW5pV2FsbGV0UHJvdmlkZXIgPSBjbGFzcyBleHRlbmRzIFByb3ZpZGVyRXZlbnRFbWl0dGVyIHtcbiAgY29uc3RydWN0b3IocHJvdmlkZXJDb25maWcpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMud2FsbGV0ID0gbnVsbDtcbiAgICB0aGlzLmNvbmZpZyA9IHByb3ZpZGVyQ29uZmlnO1xuICAgIGNvbnN0IHVzZXJEaXNjb25uZWN0Q2FsbGJhY2sgPSBwcm92aWRlckNvbmZpZy5vbkRpc2Nvbm5lY3RDYWxsYmFjaztcbiAgICB0aGlzLndhbGxldCA9IG5ldyBHZW1pbmlXYWxsZXQoe1xuICAgICAgLi4ucHJvdmlkZXJDb25maWcsXG4gICAgICBvbkRpc2Nvbm5lY3RDYWxsYmFjazogKCkgPT4ge1xuICAgICAgICB1c2VyRGlzY29ubmVjdENhbGxiYWNrPy4oKTtcbiAgICAgICAgdGhpcy5kaXNjb25uZWN0KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgcmVxdWVzdChhcmdzKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhbGlkYXRlUnBjUmVxdWVzdEFyZ3MoYXJncyk7XG4gICAgICBpZiAoIXRoaXMud2FsbGV0Py5hY2NvdW50cz8ubGVuZ3RoKSB7XG4gICAgICAgIHN3aXRjaCAoYXJncy5tZXRob2QpIHtcbiAgICAgICAgICBjYXNlIFwiZXRoX3JlcXVlc3RBY2NvdW50c1wiOiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMud2FsbGV0KSB7XG4gICAgICAgICAgICAgIGNvbnN0IHVzZXJEaXNjb25uZWN0Q2FsbGJhY2sgPSB0aGlzLmNvbmZpZy5vbkRpc2Nvbm5lY3RDYWxsYmFjaztcbiAgICAgICAgICAgICAgdGhpcy53YWxsZXQgPSBuZXcgR2VtaW5pV2FsbGV0KHtcbiAgICAgICAgICAgICAgICAuLi50aGlzLmNvbmZpZyxcbiAgICAgICAgICAgICAgICBvbkRpc2Nvbm5lY3RDYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgdXNlckRpc2Nvbm5lY3RDYWxsYmFjaz8uKCk7XG4gICAgICAgICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3QoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgdGhpcy53YWxsZXQuY29ubmVjdCgpO1xuICAgICAgICAgICAgdGhpcy5lbWl0KFwiYWNjb3VudHNDaGFuZ2VkXCIsIHRoaXMud2FsbGV0LmFjY291bnRzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXNlIFwibmV0X3ZlcnNpb25cIjpcbiAgICAgICAgICAgIHJldHVybiBERUZBVUxUX0NIQUlOX0lEO1xuICAgICAgICAgIGNhc2UgXCJldGhfY2hhaW5JZFwiOlxuICAgICAgICAgICAgcmV0dXJuIGhleFN0cmluZ0Zyb21OdW1iZXIoREVGQVVMVF9DSEFJTl9JRCk7XG4gICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgdGhyb3cgcHJvdmlkZXJFcnJvcnMyLnVuYXV0aG9yaXplZCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbGV0IHJlc3BvbnNlO1xuICAgICAgbGV0IHJlcXVlc3RQYXJhbXM7XG4gICAgICBzd2l0Y2ggKGFyZ3MubWV0aG9kKSB7XG4gICAgICAgIGNhc2UgXCJldGhfcmVxdWVzdEFjY291bnRzXCI6XG4gICAgICAgIGNhc2UgXCJldGhfYWNjb3VudHNcIjpcbiAgICAgICAgICByZXNwb25zZSA9IHRoaXMud2FsbGV0LmFjY291bnRzO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwibmV0X3ZlcnNpb25cIjpcbiAgICAgICAgICByZXNwb25zZSA9IHRoaXMud2FsbGV0LmNoYWluLmlkO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiZXRoX2NoYWluSWRcIjpcbiAgICAgICAgICByZXNwb25zZSA9IGhleFN0cmluZ0Zyb21OdW1iZXIodGhpcy53YWxsZXQuY2hhaW4uaWQpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwicGVyc29uYWxfc2lnblwiOlxuICAgICAgICBjYXNlIFwid2FsbGV0X3NpZ25cIjpcbiAgICAgICAgICByZXF1ZXN0UGFyYW1zID0gYXJncy5wYXJhbXM7XG4gICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLndhbGxldC5zaWduRGF0YSh7XG4gICAgICAgICAgICBhY2NvdW50OiByZXF1ZXN0UGFyYW1zWzFdLFxuICAgICAgICAgICAgbWVzc2FnZTogcmVxdWVzdFBhcmFtc1swXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgcnBjRXJyb3JzNC50cmFuc2FjdGlvblJlamVjdGVkKHJlc3BvbnNlLmVycm9yKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzcG9uc2UgPSByZXNwb25zZS5oYXNoO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImV0aF9zZW5kVHJhbnNhY3Rpb25cIjpcbiAgICAgICAgY2FzZSBcIndhbGxldF9zZW5kVHJhbnNhY3Rpb25cIjpcbiAgICAgICAgICByZXF1ZXN0UGFyYW1zID0gYXJncy5wYXJhbXM7XG4gICAgICAgICAgcmVxdWVzdFBhcmFtcyA9IGNvbnZlcnRTZW5kVmFsdWVzVG9CaWdJbnQocmVxdWVzdFBhcmFtc1swXSk7XG4gICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLndhbGxldC5zZW5kVHJhbnNhY3Rpb24ocmVxdWVzdFBhcmFtcyk7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBycGNFcnJvcnM0LnRyYW5zYWN0aW9uUmVqZWN0ZWQocmVzcG9uc2UuZXJyb3IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXNwb25zZSA9IHJlc3BvbnNlLmhhc2g7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwid2FsbGV0X3N3aXRjaEV0aGVyZXVtQ2hhaW5cIjoge1xuICAgICAgICAgIGNvbnN0IHJhd1BhcmFtcyA9IGFyZ3MucGFyYW1zO1xuICAgICAgICAgIGxldCBjaGFpbklkO1xuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJhd1BhcmFtcykgJiYgcmF3UGFyYW1zWzBdPy5jaGFpbklkKSB7XG4gICAgICAgICAgICBjaGFpbklkID0gcGFyc2VJbnQocmF3UGFyYW1zWzBdLmNoYWluSWQsIDE2KTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHJhd1BhcmFtcyAmJiB0eXBlb2YgcmF3UGFyYW1zID09PSBcIm9iamVjdFwiICYmIFwiaWRcIiBpbiByYXdQYXJhbXMgJiYgTnVtYmVyLmlzSW50ZWdlcihyYXdQYXJhbXMuaWQpKSB7XG4gICAgICAgICAgICBjaGFpbklkID0gcmF3UGFyYW1zLmlkO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBycGNFcnJvcnM0LmludmFsaWRQYXJhbXMoXG4gICAgICAgICAgICAgIFwiSW52YWxpZCBjaGFpbiBpZCBhcmd1bWVudC4gRXhwZWN0ZWQgW3sgY2hhaW5JZDogaGV4X3N0cmluZyB9XSBvciB7IGlkOiBudW1iZXIgfS5cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLndhbGxldC5zd2l0Y2hDaGFpbih7IGlkOiBjaGFpbklkIH0pO1xuICAgICAgICAgIGlmIChyZXNwb25zZSkge1xuICAgICAgICAgICAgdGhyb3cgcHJvdmlkZXJFcnJvcnMyLmN1c3RvbSh7IGNvZGU6IDQ5MDIsIG1lc3NhZ2U6IHJlc3BvbnNlIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCB0aGlzLmVtaXQoXCJjaGFpbkNoYW5nZWRcIiwgaGV4U3RyaW5nRnJvbU51bWJlcihjaGFpbklkKSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBcImV0aF9zaWduVHlwZWREYXRhX3YxXCI6XG4gICAgICAgIGNhc2UgXCJldGhfc2lnblR5cGVkRGF0YV92MlwiOlxuICAgICAgICBjYXNlIFwiZXRoX3NpZ25UeXBlZERhdGFfdjNcIjpcbiAgICAgICAgY2FzZSBcImV0aF9zaWduVHlwZWREYXRhX3Y0XCI6XG4gICAgICAgIGNhc2UgXCJldGhfc2lnblR5cGVkRGF0YVwiOiB7XG4gICAgICAgICAgcmVxdWVzdFBhcmFtcyA9IGFyZ3MucGFyYW1zO1xuICAgICAgICAgIGNvbnN0IHNpZ25lZFR5cGVkRGF0YVBhcmFtcyA9IEpTT04ucGFyc2UoXG4gICAgICAgICAgICByZXF1ZXN0UGFyYW1zWzFdXG4gICAgICAgICAgKTtcbiAgICAgICAgICByZXNwb25zZSA9IGF3YWl0IHRoaXMud2FsbGV0LnNpZ25UeXBlZERhdGEoe1xuICAgICAgICAgICAgYWNjb3VudDogcmVxdWVzdFBhcmFtc1swXSxcbiAgICAgICAgICAgIGRvbWFpbjogc2lnbmVkVHlwZWREYXRhUGFyYW1zLmRvbWFpbixcbiAgICAgICAgICAgIG1lc3NhZ2U6IHNpZ25lZFR5cGVkRGF0YVBhcmFtcy5tZXNzYWdlLFxuICAgICAgICAgICAgcHJpbWFyeVR5cGU6IHNpZ25lZFR5cGVkRGF0YVBhcmFtcy5wcmltYXJ5VHlwZSxcbiAgICAgICAgICAgIHR5cGVzOiBzaWduZWRUeXBlZERhdGFQYXJhbXMudHlwZXNcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IHJwY0Vycm9yczQudHJhbnNhY3Rpb25SZWplY3RlZChyZXNwb25zZS5lcnJvcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlc3BvbnNlID0gcmVzcG9uc2UuaGFzaDtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVE9ETzogbm90IHlldCBpbXBsZW1lbnRlZCBvciB1bmNsZWFyIGlmIHdlIHN1cHBvcnRcbiAgICAgICAgY2FzZSBcImV0aF9lY1JlY292ZXJcIjpcbiAgICAgICAgY2FzZSBcImV0aF9zdWJzY3JpYmVcIjpcbiAgICAgICAgY2FzZSBcImV0aF91bnN1YnNjcmliZVwiOlxuICAgICAgICBjYXNlIFwicGVyc29uYWxfZWNSZWNvdmVyXCI6XG4gICAgICAgIGNhc2UgXCJldGhfc2lnblRyYW5zYWN0aW9uXCI6XG4gICAgICAgIGNhc2UgXCJ3YWxsZXRfd2F0Y2hBc3NldFwiOlxuICAgICAgICBjYXNlIFwid2FsbGV0X3NlbmRDYWxsc1wiOlxuICAgICAgICBjYXNlIFwid2FsbGV0X2dldENhbGxzU3RhdHVzXCI6XG4gICAgICAgIGNhc2UgXCJ3YWxsZXRfZ2V0Q2FwYWJpbGl0aWVzXCI6XG4gICAgICAgIGNhc2UgXCJ3YWxsZXRfc2hvd0NhbGxzU3RhdHVzXCI6XG4gICAgICAgIGNhc2UgXCJ3YWxsZXRfZ3JhbnRQZXJtaXNzaW9uc1wiOlxuICAgICAgICAgIHRocm93IHJwY0Vycm9yczQubWV0aG9kTm90U3VwcG9ydGVkKFwiTm90IHlldCBpbXBsZW1lbnRlZC5cIik7XG4gICAgICAgIC8vIG5vdCBzdXBwb3J0ZWRcbiAgICAgICAgY2FzZSBcImV0aF9zaWduXCI6XG4gICAgICAgIGNhc2UgXCJldGhfY29pbmJhc2VcIjpcbiAgICAgICAgY2FzZSBcIndhbGxldF9hZGRFdGhlcmV1bUNoYWluXCI6XG4gICAgICAgICAgdGhyb3cgcnBjRXJyb3JzNC5tZXRob2ROb3RTdXBwb3J0ZWQoKTtcbiAgICAgICAgLy8gY2FsbCBycGMgZGlyZWN0bHkgZm9yIGV2ZXJ5dGhpbmcgZWxzZVxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGlmICghdGhpcy53YWxsZXQuY2hhaW4ucnBjVXJsKVxuICAgICAgICAgICAgdGhyb3cgcnBjRXJyb3JzNC5pbnRlcm5hbChcbiAgICAgICAgICAgICAgYFJQQyBVUkwgbWlzc2luZyBmb3IgY3VycmVudCBjaGFpbiAoJHt0aGlzLndhbGxldC5jaGFpbi5pZH0pYFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICByZXR1cm4gZmV0Y2hScGNSZXF1ZXN0KGFyZ3MsIHRoaXMud2FsbGV0LmNoYWluLnJwY1VybCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IHsgY29kZSB9ID0gZXJyb3I7XG4gICAgICBpZiAoY29kZSA9PT0gZXJyb3JDb2Rlcy5wcm92aWRlci51bmF1dGhvcml6ZWQpIHRoaXMuZGlzY29ubmVjdCgpO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHNlcmlhbGl6ZUVycm9yKGVycm9yKSk7XG4gICAgfVxuICB9XG4gIC8vIGN1c3RvbSB3YWxsZXQgZnVuY3Rpb24gdG8gb3BlbiBzZXR0aW5ncyBwYWdlXG4gIGFzeW5jIG9wZW5TZXR0aW5ncygpIHtcbiAgICBhd2FpdCB0aGlzLndhbGxldD8ub3BlblNldHRpbmdzKCk7XG4gIH1cbiAgYXN5bmMgZGlzY29ubmVjdCgpIHtcbiAgICBpZiAodGhpcy53YWxsZXQpIHtcbiAgICAgIGNvbnN0IHN0b3JhZ2UgPSB0aGlzLmNvbmZpZy5zdG9yYWdlIHx8IG5ldyBHZW1pbmlTdG9yYWdlKCk7XG4gICAgICBhd2FpdCBzdG9yYWdlLnJlbW92ZUl0ZW0oU1RPUkFHRV9FVEhfQUNDT1VOVFNfS0VZKTtcbiAgICAgIGF3YWl0IHN0b3JhZ2UucmVtb3ZlSXRlbShTVE9SQUdFX0VUSF9BQ1RJVkVfQ0hBSU5fS0VZKTtcbiAgICB9XG4gICAgdGhpcy53YWxsZXQgPSBudWxsO1xuICAgIHRoaXMuY29uZmlnLm9uRGlzY29ubmVjdENhbGxiYWNrPy4oKTtcbiAgICBhd2FpdCB0aGlzLmVtaXQoXCJkaXNjb25uZWN0XCIsIFwiVXNlciBpbml0aWF0ZWQgZGlzY29ubmVjdGlvblwiKTtcbiAgICBhd2FpdCB0aGlzLmVtaXQoXCJhY2NvdW50c0NoYW5nZWRcIiwgW10pO1xuICB9XG59O1xuZXhwb3J0IHtcbiAgQ29tbXVuaWNhdG9yLFxuICBERUZBVUxUX0NIQUlOX0lELFxuICBHZW1pbmlTZGtFdmVudCxcbiAgR2VtaW5pU3RvcmFnZSxcbiAgR2VtaW5pV2FsbGV0LFxuICBHZW1pbmlXYWxsZXRQcm92aWRlcixcbiAgUE9QVVBfSEVJR0hULFxuICBQT1BVUF9XSURUSCxcbiAgUGxhdGZvcm1UeXBlLFxuICBQcm92aWRlckV2ZW50RW1pdHRlcixcbiAgU0RLX0JBQ0tFTkRfVVJMLFxuICBTREtfVkVSU0lPTixcbiAgU1RPUkFHRV9FVEhfQUNDT1VOVFNfS0VZLFxuICBTVE9SQUdFX0VUSF9BQ1RJVkVfQ0hBSU5fS0VZLFxuICBTVE9SQUdFX1BBU1NLRVlfQ1JFREVOVElBTF9LRVksXG4gIFNUT1JBR0VfUFJFU0VSVkVEX1BBU1NLRVlfQ1JFREVOVElBTFNfS0VZLFxuICBTVE9SQUdFX1NFVFRJTkdTX0tFWSxcbiAgU1RPUkFHRV9TTUFSVF9BQ0NPVU5UX0tFWSxcbiAgU1RPUkFHRV9XQ19SRVFVRVNUU19LRVksXG4gIGJhc2U2NFRvSGV4LFxuICBidWZmZXJUb0Jhc2U2NFVSTFN0cmluZyxcbiAgY2FsY3VsYXRlVjFBZGRyZXNzLFxuICBjYWxjdWxhdGVXYWxsZXRBZGRyZXNzLFxuICBjbG9zZVBvcHVwLFxuICBjb252ZXJ0U2VuZFZhbHVlc1RvQmlnSW50LFxuICBkZWNvZGVCYXNlNjQsXG4gIGVuY29kZUJhc2U2NCxcbiAgZmV0Y2hScGNSZXF1ZXN0LFxuICBnZW5lcmF0ZUF1dGhlbnRpY2F0b3JJZEhhc2gsXG4gIGhleFN0cmluZ0Zyb21OdW1iZXIsXG4gIGlzQ2hhaW5TdXBwb3J0ZWRCeUdlbWluaVN3LFxuICBvcGVuUG9wdXAsXG4gIHJldmVyc2VSZXNvbHZlRW5zLFxuICBzYWZlSnNvblN0cmluZ2lmeSxcbiAgdXRmOFN0cmluZ1RvQnVmZmVyLFxuICB2YWxpZGF0ZVJwY1JlcXVlc3RBcmdzLFxuICB2YWxpZGF0ZVdlYkF1dGhuS2V5XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@gemini-wallet/core/dist/index.js\n");

/***/ })

};
;